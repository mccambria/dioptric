import os
import sys

import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
from scipy.optimize import curve_fit
from skimage.draw import disk

# from tabulate import tabulate
from utils import data_manager as dm
from utils import kplotlib as kpl


# Define the 2D Gaussian function
def gaussian_2d(xy, amplitude, xo, yo, sigma_x, sigma_y, theta, offset):
    x, y = xy
    xo = float(xo)
    yo = float(yo)
    a = (np.cos(theta) ** 2) / (2 * sigma_x**2) + (np.sin(theta) ** 2) / (
        2 * sigma_y**2
    )
    b = -(np.sin(2 * theta)) / (4 * sigma_x**2) + (np.sin(2 * theta)) / (4 * sigma_y**2)
    c = (np.sin(theta) ** 2) / (2 * sigma_x**2) + (np.cos(theta) ** 2) / (
        2 * sigma_y**2
    )
    g = offset + amplitude * np.exp(
        -(a * ((x - xo) ** 2) + 2 * b * (x - xo) * (y - yo) + c * ((y - yo) ** 2))
    )
    return g.ravel()


# Function to fit a 2D Gaussian around NV coordinates
def fit_gaussian(image, coord, window_size=2):
    x0, y0 = coord
    img_shape_y, img_shape_x = image.shape

    # Ensure the window is within image bounds
    x_min = max(int(x0 - window_size), 0)
    x_max = min(int(x0 + window_size + 1), img_shape_x)
    y_min = max(int(y0 - window_size), 0)
    y_max = min(int(y0 + window_size + 1), img_shape_y)

    if (x_max - x_min) <= 1 or (y_max - y_min) <= 1:
        print(
            f"Invalid cutout for NV at ({x0}, {y0}): Region too small or out of bounds"
        )
        return x0, y0

    # Extract cutout and mesh grid
    x_range = np.arange(x_min, x_max)
    y_range = np.arange(y_min, y_max)
    x, y = np.meshgrid(x_range, y_range)
    image_cutout = image[y_min:y_max, x_min:x_max]

    # Check for valid cutout size
    if image_cutout.size == 0:
        print(f"Zero-size cutout for NV at ({x0}, {y0})")
        return x0, y0

    # Normalize the image cutout
    image_cutout = (image_cutout - np.min(image_cutout)) / (
        np.max(image_cutout) - np.min(image_cutout)
    )

    # Initial guess parameters
    initial_guess = (1, x0, y0, 3, 3, 0, 0)  # Amplitude normalized to 1

    try:
        # Apply bounds to avoid unreasonable parameter values
        bounds = (
            (0, x_min, y_min, 0, 0, -np.pi, 0),  # Lower bounds
            (np.inf, x_max, y_max, np.inf, np.inf, np.pi, np.inf),  # Upper bounds
        )

        # Perform the Gaussian fit
        popt, _ = curve_fit(
            gaussian_2d, (x, y), image_cutout.ravel(), p0=initial_guess, bounds=bounds
        )
        amplitude, fitted_x, fitted_y, _, _, _, _ = popt

        return fitted_x, fitted_y, amplitude

    except Exception as e:
        print(f"Fit failed for NV at ({x0}, {y0}): {e}")
        return x0, y0, 0


def integrate_intensity(image_array, nv_coords, sigma):
    """
    Integrate the intensity around each NV coordinate within a circular region
    defined by sigma, with a Gaussian weighting if needed.
    """
    intensities = []
    for coord in nv_coords:
        # Define a larger radius to ensure full capture of intensity around bright spots
        rr, cc = disk((coord[0], coord[1]), radius=sigma, shape=image_array.shape)

        # Integrate (sum) the intensity values within the disk
        intensity = np.sum(image_array[rr, cc])

        # Append integrated intensity to the list
        intensities.append(intensity)
    return intensities


def remove_outliers(intensities, nv_coords):
    # Calculate Q1 (25th percentile) and Q3 (75th percentile)
    Q1 = np.percentile(intensities, 25)
    Q3 = np.percentile(intensities, 75)
    IQR = Q3 - Q1

    # Define bounds for identifying outliers
    lower_bound = Q1 - 1.0 * IQR
    upper_bound = Q3 + 6.5 * IQR
    # lower_bound = 10
    # upper_bound = 100

    # Filter out the outliers and corresponding NV coordinates
    filtered_intensities = []
    filtered_nv_coords = []

    for intensity, coord in zip(intensities, nv_coords):
        if lower_bound <= intensity <= upper_bound:
            filtered_intensities.append(intensity)
            filtered_nv_coords.append(coord)

    return filtered_intensities, filtered_nv_coords


def remove_manual_indices(nv_coords, indices_to_remove):
    """Remove NVs based on manually specified indices"""
    return [
        coord for idx, coord in enumerate(nv_coords) if idx not in indices_to_remove
    ]


def filter_and_reorder_nv_coords(
    nv_coordinates, integrated_intensities, reference_nv, min_distance=3
):
    """
    Filters NV coordinates based on distance from each other and reorders based on distance from a reference NV.

    """
    nv_coords = [reference_nv]  # Store as list for later operations
    # Find the closest NV to the reference_nv in case it's not an exact match
    distances_to_ref = np.linalg.norm(
        np.array(nv_coordinates) - np.array(reference_nv), axis=1
    )
    closest_index = np.argmin(distances_to_ref)  # Get the index of the closest match
    reference_nv = nv_coordinates[closest_index]  # Use this as the reference
    included_indices = [closest_index]  # Track included indices

    # Filter NV coordinates based on minimum distance
    for idx, coord in enumerate(nv_coordinates):
        keep_coord = True
        for existing_coord in nv_coords:
            distance = np.linalg.norm(np.array(existing_coord) - np.array(coord))
            if distance < min_distance:
                keep_coord = False
                break
        if keep_coord:
            nv_coords.append(coord)
            included_indices.append(idx)
            # intensities.append(integrated_intensities[idx])  # Store matching intensity
    print(included_indices)
    # Reorder based on distance to the reference NV
    distances = [
        np.linalg.norm(np.array(coord) - np.array(reference_nv)) for coord in nv_coords
    ]
    sorted_indices = np.argsort(distances)
    reordered_coords = [nv_coords[idx] for idx in sorted_indices]
    reordered_intensities = [integrated_intensities[idx] for idx in sorted_indices]

    return reordered_coords, reordered_intensities, included_indices


def sigmoid_weights(intensities, threshold, beta=1):
    weights = np.exp(beta * (intensities - threshold))
    return weights / np.max(weights)  # Normalize the weights


def linear_weights(intensities, alpha=1):
    weights = 1 / np.power(intensities, alpha)
    weights = weights / np.max(weights)  # Normalize to avoid extreme values
    return weights


def non_linear_weights_adjusted(intensities, alpha=1, beta=0.5, threshold=0.5):
    # Normalize the intensities between 0 and 1
    norm_intensities = intensities / np.max(intensities)

    # Apply a non-linear transformation to only the lower intensities
    weights = np.where(
        norm_intensities > threshold,
        1,  # Keep bright NVs the same
        1
        / (1 + np.exp(-beta * (norm_intensities - threshold)))
        ** alpha,  # Non-linear scaling for low intensities
    )

    # Ensure that the weights are normalized
    weights = weights / np.max(weights)

    return weights


# Save the results to a file
def save_results(nv_coordinates, updated_spot_weights, filename):
    # Ensure the directory exists
    path = os.path.dirname(filename)
    if not os.path.exists(path):
        os.makedirs(path)  # Create the directory if it doesn't exist

    # Save the data to a .npz file
    np.savez(
        filename,
        nv_coordinates=nv_coordinates,
        # integrated_counts=integrated_intensities,
        # spot_weights=spot_weights,
        # nv_powers=nv_powers,
        updated_spot_weights=updated_spot_weights,
    )


def filter_by_snr(snr_list, threshold=0.5):
    """Filter out NVs with SNR below the threshold."""
    return [i for i, snr in enumerate(snr_list) if snr >= threshold]


def load_nv_coords(
    # file_path="slmsuite/nv_blob_detection/nv_blob_filtered_77nvs_new.npz",
    file_path="slmsuite/nv_blob_detection/nv_blob_filtered_240nvs.npz",
):
    data = np.load(file_path)
    print(data.keys())
    nv_coordinates = data["nv_coordinates"]
    # spot_weights = data["spot_weights"]
    spot_weights = data["updated_spot_weights"]
    # spot_weights = data["integrated_counts"]
    # spot_weights = data["integrated_counts"]
    return nv_coordinates, spot_weights


def load_nv_weights(file_path="optimal_separation_and_goodness.txt"):
    # Load data, skipping the header row
    data = np.loadtxt(file_path, delimiter=",", skiprows=1)
    # Extract the step values for separation
    nv_weights = data[:, 2]  # Step Val (Separation) is the 3rd column (index 2)
    return nv_weights


def sigmoid_weight_update(
    fidelities, spot_weights, intensities, alpha=1, beta=10, fidelity_threshold=0.90
):
    # Normalize intensities between 0 and 1
    norm_intensities = intensities / np.max(intensities)

    # Initialize updated weights as 1 (i.e., no change for high-fidelity NVs)
    updated_weights = np.copy(spot_weights)

    # Loop over each NV and update weights for those with fidelity < fidelity_threshold
    for i, fidelity in enumerate(fidelities):
        if fidelity < fidelity_threshold:
            # Use a sigmoid to adjust the weight based on intensity
            updated_weights[i] = (
                1 / (1 + np.exp(-beta * (norm_intensities[i]))) ** alpha
            )

    # Normalize the updated weights to avoid extreme values
    updated_weights = updated_weights / np.max(updated_weights)

    return updated_weights


def manual_sigmoid_weight_update(
    spot_weights, intensities, alpha, beta, update_indices
):
    updated_spot_weights = (
        spot_weights.copy()
    )  # Make a copy to avoid mutating the original list
    norm_intensities = intensities / np.max(intensities)
    for idx in update_indices:
        print(f"NV Index {idx}: Weight before update: {updated_spot_weights[idx]}")

        # Apply the sigmoid weight update for the specific NV
        weight_update = 1 / (1 + np.exp(-beta * (norm_intensities[idx]))) ** alpha
        updated_spot_weights[idx] = weight_update  # Update weight for this NV

        print(f"NV Index {idx}: Weight after update: {updated_spot_weights[idx]}")

    return updated_spot_weights


# Adjust weights based on SNR values
def adjust_weights_sigmoid(spot_weights, snr_values, alpha=1.0, beta=0.001):
    """Apply sigmoid adjustment to spot weights based on SNR values."""
    updated_weights = np.copy(spot_weights)
    for i, value in enumerate(snr_values):
        if value < 0.9:
            # Sigmoid-based weight adjustment
            updated_weights[i] = 1 / (1 + np.exp(-beta * (value - alpha)))
    return updated_weights


def filter_by_peak_intensity(fitted_data, threshold=0.5):
    filtered_coords = []
    filtered_intensities = []

    for x, y, intensity in fitted_data:
        if intensity >= threshold:
            filtered_coords.append((x, y))
            filtered_intensities.append(intensity)

    return filtered_coords, filtered_intensities


def adjust_aom_voltage_for_slm(nv_amp, aom_voltage, power_law_params):
    nv_amp = np.array(nv_amp)
    a, b, c = power_law_params

    aom_voltages = nv_amp * aom_voltage

    nv_powers = a * (aom_voltages**b) + c
    scaled_nv_powers = nv_powers / (len(nv_powers))
    # Normalize powers across all spots
    total_power = np.sum(scaled_nv_powers)
    nv_weights = nv_powers / total_power
    # Compute adjusted AOM voltage for the total power
    adjusted_aom_voltage = ((total_power - c) / a) ** (1 / b)
    return nv_weights, adjusted_aom_voltage


def curve_extreme_weights_simple(weights, scaling_factor=1.0):
    median = np.median(weights)

    curved_weights = [1 / (1 + np.exp(-scaling_factor * (w - median))) for w in weights]

    return curved_weights


def curve_inverse_counts(counts, scaling_factor=0.5):
    median_count = np.median(counts)
    adjusted_weights = np.exp(-scaling_factor * (counts / median_count))
    adjusted_weights /= np.max(adjusted_weights)
    return adjusted_weights


def select_half_left_side_nvs_and_plot(nv_coordinates):
    # Filter NVs on the left side (x < median x)
    median_x = np.median(nv_coordinates[:, 0])
    left_side_indices = [
        i for i, coord in enumerate(nv_coordinates) if coord[0] < median_x
    ]

    # Randomly select half of the NVs from the left side
    print(f"Selected {len(left_side_indices)} NVs from the left side.")

    # Plot distribution
    plt.figure(figsize=(10, 7))

    # Plot all NVs
    plt.scatter(
        nv_coordinates[:, 0], nv_coordinates[:, 1], color="gray", label="All NVs"
    )

    # Highlight left-side NVs
    left_coords = nv_coordinates[left_side_indices]
    plt.scatter(
        left_coords[:, 0], left_coords[:, 1], color="blue", label="Left Side NVs"
    )

    # Add median line
    plt.axvline(
        median_x, color="green", linestyle="--", label=f"Median X = {median_x:.2f}"
    )

    # Labels and legend
    plt.title("NV Distribution with Left Side Selection", fontsize=16)
    plt.xlabel("X Coordinate", fontsize=14)
    plt.ylabel("Y Coordinate", fontsize=14)
    plt.legend(fontsize=12)
    plt.grid(True)
    plt.show()

    return


# Main section of the code
if __name__ == "__main__":
    kpl.init_kplotlib()
    # Parameters
    remove_outliers_flag = False  # Set this flag to enable/disable outlier removal
    reorder_coords_flag = True  # Set this flag to enable/disable reordering of NVs
    # data = dm.get_raw_data(file_id=1700710358100, load_npz=True)
    # data = dm.get_raw_data(file_id=1733432867671, load_npz=True)
    # data = dm.get_raw_data(file_id=1732420670067, load_npz=True)
    # data = dm.get_raw_data(file_id=1751170993877, load_npz=True)
    # data = dm.get_raw_data(file_id=1752794666146, load_npz=True)
    # data = dm.get_raw_data(file_id=1782616297820, load_npz=True)
    # data = dm.get_raw_data(file_id=1806410973406, load_npz=True)
    data = dm.get_raw_data(
        file_stem="2025_09_19-18_30_17-rubin-nv0_2025_09_08",
        # file_stem="2025_09_17-21_55_38-combined_image_array",
        load_npz=True,
    )
    img_array = np.array(data["ref_img_array"])
    # img_array = data["img_array"]

    # sys.exit()
    nv_coordinates, spot_weights = load_nv_coords(
        # file_path="slmsuite/nv_blob_detection/nv_blob_shallow_rubin_140nvs.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_shallow_rubin_306nvs.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_shallow_rubin_81nvs.npz"
        file_path="slmsuite/nv_blob_detection/nv_blob_339nvs.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_shallow_rubin_75nvs_reordered_.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_rubin_shallow_303nvs_reordered.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_rubin_shallow_154nvs_reordered.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_shallow_rubin_243nvs.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_rubin_shallow_140nvs_reordered_updated.npz",
        # file_path="slmsuite/nv_blob_detection/nv_blob_rubin_shallow_255nvs_reordered_updated.npz"
        # file_path="slmsuite/nv_blob_detection/nv_blob_filtered_160nvs_reordered.npz"
    )
    # Convert coordinates to a standard format (lists of lists)
    # nv_coordinates = [[coord[0] - 3, coord[1] + 3] for coord in nv_coordinates]
    nv_coordinates = [list(coord) for coord in nv_coordinates]
    # Debug: Print before filtering
    # print(f"Before filtering: {len(nv_coordinates)} NVs")
    # print(f"Sample NV coordinates: {nv_coordinates[:10]}")  # Check first 10 NVs

    # Filter NV coordinates: Keep only those where both x and y are in [0, 250]
    nv_coordinates_filtered = [
        coord
        for coord in nv_coordinates
        if isinstance(coord, (list, tuple))
        and len(coord) == 2
        and all(1 <= x <= 249 for x in coord)
    ]

    # Ensure spot weights are filtered accordingly
    spot_weights_filtered = [
        weight
        for coord, weight in zip(nv_coordinates, spot_weights)
        if isinstance(coord, (list, tuple))
        and len(coord) == 2
        and all(1 <= x <= 249 for x in coord)
    ]

    # Replace original lists with filtered versions
    nv_coordinates = nv_coordinates_filtered
    spot_weights = spot_weights_filtered

    print(f"After filtering: {len(spot_weights)} NVs")

    # Filter and reorder NV coordinates based on reference NV
    # integrated_intensities = []
    sigma = 3
    # reference_nv = [109.077, 120.824]
    # reference_nv = [120.258, 124.709]
    reference_nv = [124.195, 127.341]
    filtered_reordered_coords, filtered_reordered_spot_weights, include_indices = (
        filter_and_reorder_nv_coords(
            nv_coordinates, spot_weights, reference_nv, min_distance=6
        )
    )
    # filtered_reordered_coords = [
    #     [coord[0] - 5, coord[1] - 0] for coord in filter_and_reorder_nv_coords
    # ]

    # Integration over disk region around each NV coordinate
    # filtered_reordered_counts = []
    # integration_radius = 3.0
    # for coord in filtered_reordered_coords:
    #     x, y = coord[:2]  # Assuming `coord` contains at least two elements (y, x)
    #     rr, cc = disk((y, x), integration_radius, shape=img_array.shape)
    #     sum_value = np.sum(img_array[rr, cc])
    #     filtered_reordered_counts.append(sum_value)

    # # calcualte spot weight  based on
    # calcualted_spot_weights = linear_weights(filtered_reordered_counts, alpha=0.3)
    # filtered_reordered_spot_weights = calcualted_spot_weights
    # Manually remove NVs with specified indices
    # indices_to_remove = [1, 4]
    # filtered_reordered_coords_0 = [
    #     coord
    #     for i, coord in enumerate(filtered_reordered_coords)
    #     if i not in indices_to_remove
    # ]
    # filtered_reordered_spot_weights_0 = [
    #     count
    #     for i, count in enumerate(filtered_reordered_spot_weights)
    #     if i not in indices_to_remove
    # ]
    # filtered_reordered_coords = filtered_reordered_coords_0
    # filtered_reordered_spot_weights = filtered_reordered_spot_weights_0

    # print(filtered_reordered_coords)
    # print("Filter:", filtered_reordered_counts)
    # print("Filtered and Reordered NV Coordinates:", filtered_reordered_coords)
    # print("Filtered and Reordered NV Coordinates:", integrated_intensities)

    # Initialize lists to store the results
    # fitted_amplitudes = []
    # for coord in filtered_reordered_coords:
    #     fitted_x, fitted_y, amplitude = fit_gaussian(img_array, coord, window_size=2)
    #     fitted_amplitudes.append(amplitude)

    # fmt: off
    # spots weights for 117 NVs before Birge shutdown
    # spot_weights = [0.7466728351068052, 0.7466728351068052, 0.6384167684513203, 1.1708211389400445, 1.5561808283609733, 1.1708211389400445, 0.6384167684513203, 0.7466728351068052, 1.1708211389400445, 0.7466728351068052, 0.7466728351068052, 0.6384167684513203, 1.1708211389400445, 0.7466728351068052, 0.7466728351068052, 0.7466728351068052, 0.8702844369863524, 0.7466728351068052, 0.8702844369863524, 0.6384167684513203, 0.8702844369863524, 0.6384167684513203, 1.0110233833356788, 0.6384167684513203, 0.6384167684513203, 0.8702844369863524, 1.5561808283609733, 0.8702844369863524, 0.8702844369863524, 1.3517793512995497, 0.7466728351068052, 0.8702844369863524, 1.5561808283609733, 0.7466728351068052, 0.8702844369863524, 0.7466728351068052, 1.0110233833356788, 0.7466728351068052, 0.5438939973931943, 0.7466728351068052, 3.023897571362437, 0.7466728351068052, 0.8702844369863524, 0.8702844369863524, 0.7466728351068052, 1.0110233833356788, 0.6384167684513203, 0.7466728351068052, 0.7466728351068052, 1.0110233833356788, 0.5438939973931943, 0.7466728351068052, 1.5561808283609733, 1.5561808283609733, 1.0110233833356788, 0.7466728351068052, 1.3517793512995497, 0.6384167684513203, 1.0110233833356788, 0.7466728351068052, 0.7466728351068052, 0.8702844369863524, 1.0110233833356788, 1.5561808283609733, 1.1708211389400445, 1.0110233833356788, 0.6384167684513203, 0.8702844369863524, 0.8702844369863524, 0.7466728351068052, 0.6384167684513203, 0.7466728351068052, 0.8702844369863524, 1.0110233833356788, 0.8702844369863524, 0.8702844369863524, 0.7466728351068052, 1.3517793512995497, 1.5561808283609733, 1.0110233833356788, 0.8702844369863524, 0.7466728351068052, 0.8702844369863524, 1.0110233833356788, 0.8702844369863524, 1.0110233833356788, 1.1708211389400445, 1.5561808283609733, 0.8702844369863524, 0.8702844369863524, 1.3517793512995497, 0.7466728351068052, 1.0110233833356788, 1.0110233833356788, 1.5561808283609733, 2.0454197052578524, 0.7466728351068052, 1.7865009761020008, 2.0454197052578524, 1.1708211389400445, 1.1708211389400445, 1.1708211389400445, 1.0110233833356788, 1.5561808283609733, 0.8702844369863524, 1.3517793512995497, 1.0110233833356788, 0.7466728351068052, 2.0454197052578524, 0.7466728351068052, 0.8702844369863524, 0.7466728351068052, 1.1708211389400445, 1.7865009761020008, 0.7466728351068052, 0.8702844369863524, 1.1708211389400445]
    # spot_weights = [0.3268459239007881, 1.7928139326333443, 1.2539168761234627, 1.7928139326333443, 0.6612479042019478, 0.5030856545812062, 0.3268459239007881, 1.5946285103642925, 1.4155138353948802, 0.577544072380617, 0.577544072380617, 0.3785057034159371, 1.7928139326333443, 1.2539168761234627, 1.7928139326333443, 0.5030856545812062, 1.5946285103642925, 1.7928139326333443, 1.1083873273376117, 0.577544072380617, 1.7928139326333443, 0.3268459239007881, 1.1083873273376117, 0.6612479042019478, 0.3785057034159371, 1.1083873273376117, 0.8602120251720561, 1.7928139326333443, 0.43700628320563345, 0.43700628320563345, 0.3785057034159371, 0.577544072380617, 0.9775724397515285, 0.20638881548889623, 1.2539168761234627, 1.5946285103642925, 0.2813475193074132, 0.7551336343037693, 0.6612479042019478, 0.2813475193074132, 1.7928139326333443, 0.20638881548889623, 0.577544072380617, 0.43700628320563345, 1.7928139326333443, 0.7551336343037693, 0.43700628320563345, 0.20638881548889623, 1.5946285103642925, 1.4155138353948802, 0.9775724397515285, 1.2539168761234627, 1.1083873273376117, 0.577544072380617, 0.8602120251720561, 1.5946285103642925, 0.3268459239007881, 0.43700628320563345, 1.2539168761234627, 1.1083873273376117, 0.2813475193074132, 1.1083873273376117, 0.6612479042019478, 0.24138608133564415, 0.24138608133564415, 1.2539168761234627, 1.2539168761234627, 1.5946285103642925, 1.7928139326333443, 1.5946285103642925, 0.2813475193074132, 0.9775724397515285, 0.7551336343037693, 1.4155138353948802, 0.3785057034159371, 1.5946285103642925, 0.6612479042019478, 0.8602120251720561, 1.7928139326333443, 0.5030856545812062, 0.5030856545812062, 1.5946285103642925, 0.3785057034159371, 0.6612479042019478, 1.5946285103642925, 0.577544072380617, 1.5946285103642925, 0.9775724397515285, 1.7928139326333443, 0.43700628320563345, 0.3268459239007881, 1.7928139326333443, 0.43700628320563345, 1.7928139326333443, 0.577544072380617, 1.5946285103642925, 0.43700628320563345, 1.7928139326333443, 1.7928139326333443, 0.7551336343037693, 1.4155138353948802, 0.9775724397515285, 1.1083873273376117, 1.7928139326333443, 0.43700628320563345, 0.20638881548889623, 1.7928139326333443, 1.7928139326333443, 0.43700628320563345, 0.2813475193074132, 1.7928139326333443, 0.43700628320563345, 1.7928139326333443, 0.24138608133564415, 0.43700628320563345, 0.2813475193074132, 0.9775724397515285, 1.1083873273376117, 0.5030856545812062, 0.7551336343037693, 1.5946285103642925, 0.5030856545812062, 0.6612479042019478, 0.8602120251720561, 0.3785057034159371, 0.3268459239007881, 1.2539168761234627, 1.7928139326333443, 1.2539168761234627, 0.17583128047499216, 0.43700628320563345, 0.3785057034159371, 0.3268459239007881, 0.6612479042019478, 0.5030856545812062, 1.1083873273376117, 0.17583128047499216, 1.7928139326333443, 0.9775724397515285, 0.2813475193074132, 1.7928139326333443, 0.3268459239007881, 1.7928139326333443, 0.43700628320563345, 1.2539168761234627, 0.3785057034159371, 1.7928139326333443, 0.9775724397515285, 1.7928139326333443, 0.3785057034159371, 1.7928139326333443, 0.43700628320563345, 1.7928139326333443, 1.4155138353948802, 0.2813475193074132, 0.20638881548889623, 1.7928139326333443, 1.7928139326333443, 1.2539168761234627, 1.5946285103642925, 1.4155138353948802, 1.7928139326333443, 0.9775724397515285, 1.5946285103642925, 1.5946285103642925, 0.43700628320563345, 0.7551336343037693, 1.4155138353948802, 0.3268459239007881, 1.7928139326333443, 1.5946285103642925, 0.9775724397515285, 0.43700628320563345, 1.7928139326333443, 1.5946285103642925, 1.1083873273376117, 0.43700628320563345, 0.3268459239007881, 1.7928139326333443, 1.7928139326333443, 1.5946285103642925, 0.3268459239007881, 0.5030856545812062, 0.20638881548889623, 1.4155138353948802, 0.3785057034159371, 0.5030856545812062, 0.5030856545812062, 1.5946285103642925, 0.1492342672477611, 0.1492342672477611, 1.7928139326333443, 1.1083873273376117, 0.9775724397515285, 0.43700628320563345, 1.5946285103642925, 1.4155138353948802, 0.7551336343037693, 1.7928139326333443, 0.6612479042019478, 1.7928139326333443, 1.7928139326333443, 1.2539168761234627, 1.7928139326333443, 1.2539168761234627, 0.9775724397515285, 0.2813475193074132, 1.7928139326333443, 1.1083873273376117, 0.8602120251720561, 1.1083873273376117, 0.9775724397515285, 0.3268459239007881, 0.577544072380617, 1.5946285103642925, 1.7928139326333443, 1.2539168761234627, 1.7928139326333443, 0.3785057034159371, 1.7928139326333443, 0.43700628320563345, 0.6612479042019478, 0.5030856545812062, 0.3785057034159371, 1.7928139326333443, 1.2539168761234627, 1.5946285103642925, 0.17583128047499216, 1.5946285103642925, 0.2813475193074132, 1.1083873273376117, 0.577544072380617, 0.24138608133564415, 0.3785057034159371, 0.5030856545812062, 1.2539168761234627, 1.5946285103642925, 1.7928139326333443, 0.8602120251720561, 0.8602120251720561, 0.7551336343037693, 0.6612479042019478, 0.577544072380617, 0.7551336343037693, 1.7928139326333443, 1.1083873273376117, 1.7928139326333443, 0.1492342672477611, 1.7928139326333443, 1.7928139326333443, 0.20638881548889623, 0.3268459239007881, 0.3268459239007881, 1.7928139326333443, 1.7928139326333443, 1.5946285103642925, 0.8602120251720561, 0.2813475193074132, 0.577544072380617, 1.2539168761234627, 0.10621335884311792, 1.7928139326333443, 0.3268459239007881, 1.7928139326333443, 1.1083873273376117, 0.2813475193074132, 1.4155138353948802, 1.2539168761234627, 0.5030856545812062, 1.1083873273376117, 0.20638881548889623, 1.7928139326333443, 0.577544072380617, 1.7928139326333443, 0.6612479042019478, 0.3268459239007881, 1.7928139326333443, 0.43700628320563345, 1.7928139326333443, 1.5946285103642925, 0.8602120251720561, 0.9775724397515285, 0.20638881548889623, 0.6612479042019478, 1.4155138353948802, 1.5946285103642925, 0.20638881548889623, 0.6612479042019478, 1.7928139326333443, 1.7928139326333443, 0.20638881548889623, 1.4155138353948802, 1.1083873273376117, 1.7928139326333443, 0.3268459239007881, 1.1083873273376117, 1.1083873273376117, 0.12616081467834883, 0.10621335884311792, 1.7928139326333443, 0.8602120251720561, 1.7928139326333443, 0.5030856545812062, 1.7928139326333443, 1.5946285103642925, 0.9775724397515285, 1.4155138353948802, 1.2539168761234627, 0.3785057034159371]
    # spot_weights = [0.36251221979455894, 0.3099535285119251, 0.5684376745791714, 1.134055321244281, 0.9930582751929002, 0.2640623992966607, 0.65629350670291, 0.7555311241638751, 0.65629350670291, 0.4908553167128364, 0.36251221979455894, 0.36251221979455894, 0.65629350670291, 0.65629350670291, 0.36251221979455894, 0.3099535285119251, 0.65629350670291, 2.692437587127595, 1.2918614404510307, 1.6645696727915855, 0.5684376745791714, 0.422526076041661, 0.2241191587769138, 0.3099535285119251, 2.692437587127595, 0.4908553167128364, 0.65629350670291, 0.7555311241638751, 0.36251221979455894, 0.7555311241638751, 0.7555311241638751, 1.134055321244281, 0.3099535285119251, 1.4681126317782422, 0.422526076041661, 1.8831251068255075, 0.36251221979455894, 0.2241191587769138, 0.5684376745791714, 0.4908553167128364, 0.36251221979455894, 0.422526076041661, 1.8831251068255075, 0.3099535285119251, 0.4908553167128364, 0.36251221979455894, 0.9930582751929002, 0.3099535285119251, 0.8673523450457992, 0.422526076041661, 1.6645696727915855, 2.692437587127595, 0.2640623992966607, 2.394803867071558, 0.422526076041661, 0.65629350670291, 0.7555311241638751, 0.2640623992966607, 1.2918614404510307, 0.4908553167128364, 0.5684376745791714, 0.3099535285119251, 2.1258104849276394, 0.422526076041661, 0.36251221979455894, 0.422526076041661, 0.36251221979455894, 0.3099535285119251, 0.422526076041661, 0.2640623992966607, 0.8673523450457992, 0.422526076041661, 0.65629350670291, 0.36251221979455894, 1.6645696727915855, 0.65629350670291, 1.6645696727915855, 0.65629350670291, 0.3099535285119251, 1.8831251068255075, 0.422526076041661, 0.5684376745791714, 2.394803867071558, 2.394803867071558, 0.65629350670291, 0.36251221979455894, 0.8673523450457992, 2.1258104849276394, 0.36251221979455894, 1.134055321244281, 1.2918614404510307, 0.2640623992966607, 2.1258104849276394, 0.3099535285119251, 0.4908553167128364, 0.2640623992966607, 0.5684376745791714, 0.7555311241638751, 0.5684376745791714, 0.422526076041661, 0.2640623992966607, 1.6645696727915855, 2.394803867071558, 1.6645696727915855, 0.3099535285119251, 2.692437587127595, 0.2640623992966607, 0.36251221979455894, 2.1258104849276394, 0.36251221979455894, 2.1258104849276394, 2.394803867071558, 2.692437587127595, 0.4908553167128364, 0.4908553167128364, 0.2640623992966607, 0.4908553167128364, 1.4681126317782422, 0.3099535285119251, 0.2640623992966607, 0.36251221979455894, 0.4908553167128364, 0.65629350670291, 2.692437587127595, 0.4908553167128364, 0.8673523450457992, 0.4908553167128364, 0.5684376745791714, 0.5684376745791714, 2.1258104849276394, 2.692437587127595, 0.5684376745791714, 1.2918614404510307, 0.422526076041661, 2.1258104849276394, 1.6645696727915855, 1.2918614404510307, 1.4681126317782422, 2.692437587127595, 1.134055321244281, 0.36251221979455894, 0.8673523450457992, 0.422526076041661, 2.692437587127595, 0.36251221979455894, 0.65629350670291, 1.6645696727915855, 1.134055321244281, 0.36251221979455894, 2.394803867071558, 0.65629350670291, 1.6645696727915855, 0.3099535285119251, 0.5684376745791714, 0.4908553167128364, 0.7555311241638751, 0.5684376745791714, 0.9930582751929002, 0.65629350670291, 0.2640623992966607, 1.4681126317782422, 0.8673523450457992, 0.4908553167128364, 2.692437587127595, 2.394803867071558, 0.36251221979455894, 2.1258104849276394, 0.5684376745791714, 0.4908553167128364, 2.692437587127595, 0.4908553167128364, 2.692437587127595, 1.134055321244281, 0.5684376745791714, 0.5684376745791714, 2.394803867071558, 1.2918614404510307, 0.65629350670291, 1.6645696727915855, 2.394803867071558, 2.1258104849276394, 0.7555311241638751, 0.7555311241638751, 0.5684376745791714, 0.7555311241638751, 0.5684376745791714, 2.394803867071558, 0.4908553167128364, 2.1258104849276394, 0.36251221979455894, 2.692437587127595, 1.4681126317782422, 0.3099535285119251, 0.3099535285119251, 0.2241191587769138, 0.2640623992966607, 0.36251221979455894, 2.1258104849276394, 0.65629350670291, 2.692437587127595, 0.422526076041661, 0.36251221979455894, 0.422526076041661, 0.8673523450457992, 1.6645696727915855, 0.422526076041661, 0.9930582751929002, 0.7555311241638751, 2.394803867071558, 0.3099535285119251, 0.4908553167128364, 1.8831251068255075, 0.18946758125852564, 0.4908553167128364, 0.5684376745791714, 0.422526076041661, 1.2918614404510307, 2.394803867071558, 1.4681126317782422, 2.692437587127595, 0.2640623992966607, 0.65629350670291, 0.4908553167128364, 2.692437587127595, 1.8831251068255075, 1.4681126317782422, 0.2241191587769138, 0.2640623992966607, 0.422526076041661, 0.7555311241638751, 2.394803867071558, 0.65629350670291, 0.65629350670291, 0.4908553167128364, 0.9930582751929002, 2.394803867071558, 2.1258104849276394, 0.7555311241638751, 1.134055321244281, 0.3099535285119251, 2.692437587127595, 0.8673523450457992, 0.422526076041661, 0.3099535285119251, 2.394803867071558, 1.4681126317782422, 1.8831251068255075, 1.4681126317782422, 1.2918614404510307, 0.422526076041661, 0.36251221979455894, 2.692437587127595, 0.15951060754209728, 0.7555311241638751, 0.18946758125852564]
    # rubin 140NVS
    # spot_weights =[1.6879980285180725, 0.7055032661433738, 0.513905118219262, 1.6879980285180725, 1.4703771256943128, 0.7055032661433738, 1.1062651522252733, 1.2772458064723715, 0.8222992506213154, 1.2772458064723715, 0.9552782230099706, 1.2772458064723715, 0.9552782230099706, 1.1062651522252733, 0.8222992506213154, 0.9552782230099706, 0.8222992506213154, 0.8222992506213154, 0.513905118219262, 0.513905118219262, 1.1062651522252733, 0.6032161532147851, 0.9552782230099706, 0.513905118219262, 0.513905118219262, 1.1062651522252733, 0.513905118219262, 0.6032161532147851, 1.4703771256943128, 0.7055032661433738, 0.513905118219262, 0.8222992506213154, 0.9552782230099706, 0.9552782230099706, 1.1062651522252733, 0.9552782230099706, 0.513905118219262, 3.2395027719153773, 0.7055032661433738, 0.513905118219262, 0.9552782230099706, 0.8222992506213154, 5.239888224132664, 0.6032161532147851, 0.9552782230099706, 0.7055032661433738, 2.857167842156806, 0.513905118219262, 0.6032161532147851, 1.1062651522252733, 0.7055032661433738, 2.5141565328732822, 0.6032161532147851, 0.6032161532147851, 0.7055032661433738, 0.7055032661433738, 0.9552782230099706, 0.8222992506213154, 0.6032161532147851, 0.8222992506213154, 1.4703771256943128, 0.7055032661433738, 0.6032161532147851, 1.2772458064723715, 0.4361695686066121, 0.7055032661433738, 0.9552782230099706, 0.7055032661433738, 2.20704210627308, 0.8222992506213154, 0.8222992506213154, 0.9552782230099706, 0.6032161532147851, 0.8222992506213154, 1.9326406624757093, 0.8222992506213154, 0.8222992506213154, 0.9552782230099706, 0.6032161532147851, 0.8222992506213154, 0.8222992506213154, 0.7055032661433738, 0.7055032661433738, 0.6032161532147851, 0.7055032661433738, 0.7055032661433738, 0.6032161532147851, 0.9552782230099706, 1.4703771256943128, 1.6879980285180725, 0.9552782230099706, 0.6032161532147851, 0.8222992506213154, 1.1062651522252733, 0.9552782230099706, 1.6879980285180725, 0.8222992506213154, 0.6032161532147851, 0.8222992506213154, 1.1062651522252733, 0.9552782230099706, 0.9552782230099706, 0.513905118219262, 0.368732390543766, 0.7055032661433738, 1.1062651522252733, 0.9552782230099706, 0.513905118219262, 0.9552782230099706, 1.4703771256943128, 0.8222992506213154, 1.1062651522252733, 0.7055032661433738, 0.9552782230099706, 1.6879980285180725, 1.2772458064723715, 0.4361695686066121, 1.4703771256943128, 0.9552782230099706, 1.1062651522252733, 0.6032161532147851, 1.2772458064723715, 0.9552782230099706, 0.6032161532147851, 0.9552782230099706, 0.8222992506213154, 0.6032161532147851, 0.7055032661433738, 5.239888224132664, 1.2772458064723715, 0.8222992506213154, 0.8222992506213154, 0.6032161532147851, 1.1062651522252733, 0.6032161532147851, 1.6879980285180725, 0.6032161532147851, 0.7055032661433738, 0.6032161532147851, 1.1062651522252733]
    # spot_weights = [1.7503870973405176, 0.6831822937120458, 0.46812597079568075, 1.7503870973405176, 1.5176575965225905, 0.6831822937120458, 1.124177809846665, 1.3096550379797565, 0.8127678004953688, 1.3096550379797565, 0.9591809260509082, 1.3096550379797565, 0.9591809260509082, 1.124177809846665, 0.8127678004953688, 0.9591809260509082, 0.8127678004953688, 0.8127678004953688, 0.46812597079568075, 0.46812597079568075, 1.124177809846665, 0.56880102847055, 0.9591809260509082, 0.46812597079568075, 0.46812597079568075, 1.124177809846665, 0.46812597079568075, 0.56880102847055, 1.5176575965225905, 0.6831822937120458, 0.46812597079568075, 0.8127678004953688, 0.9591809260509082, 0.9591809260509082, 1.124177809846665, 0.9591809260509082, 0.46812597079568075, 3.374053775256749, 0.6831822937120458, 0.46812597079568075, 0.9591809260509082, 0.8127678004953688, 5.409887870979694, 0.56880102847055, 0.9591809260509082, 0.6831822937120458, 2.9785726142604827, 0.46812597079568075, 0.56880102847055, 1.124177809846665, 0.6831822937120458, 2.621483255718742, 0.56880102847055, 0.56880102847055, 0.6831822937120458, 0.6831822937120458, 0.9591809260509082, 0.8127678004953688, 0.56880102847055, 0.8127678004953688, 1.5176575965225905, 0.6831822937120458, 0.56880102847055, 1.3096550379797565, 0.37977727281885115, 0.6831822937120458, 0.9591809260509082, 0.6831822937120458, 2.2996677923175044, 0.8127678004953688, 0.8127678004953688, 0.9591809260509082, 0.56880102847055, 0.8127678004953688, 2.010210279869792, 0.8127678004953688, 0.8127678004953688, 0.9591809260509082, 0.56880102847055, 0.8127678004953688, 0.8127678004953688, 0.6831822937120458, 0.6831822937120458, 0.56880102847055, 0.6831822937120458, 0.6831822937120458, 0.56880102847055, 0.9591809260509082, 1.5176575965225905, 1.7503870973405176, 0.9591809260509082, 0.56880102847055, 0.8127678004953688, 1.124177809846665, 0.9591809260509082, 1.7503870973405176, 0.8127678004953688, 0.56880102847055, 0.8127678004953688, 1.124177809846665, 0.9591809260509082, 0.9591809260509082, 0.46812597079568075, 0.3024863738575359, 0.6831822937120458, 1.124177809846665, 0.9591809260509082, 0.46812597079568075, 0.9591809260509082, 1.5176575965225905, 0.8127678004953688, 1.124177809846665, 0.6831822937120458, 0.9591809260509082, 1.7503870973405176, 1.3096550379797565, 0.37977727281885115, 1.5176575965225905, 0.9591809260509082, 1.124177809846665, 0.56880102847055, 1.3096550379797565, 0.9591809260509082, 0.56880102847055, 0.9591809260509082, 0.8127678004953688, 0.56880102847055, 0.6831822937120458, 5.409887870979694, 1.3096550379797565, 0.8127678004953688, 0.8127678004953688, 0.56880102847055, 1.124177809846665, 0.56880102847055, 1.7503870973405176, 0.56880102847055, 0.6831822937120458, 0.56880102847055, 1.124177809846665]
    # spot_weights = [0.4407235911329617, 0.6600817106484301, 0.5432504094316501, 1.1131094263163939, 1.7612099351945598, 0.7928187794082265, 1.3045848629913512, 1.5198273114124148, 0.9432000528436495, 1.5198273114124148, 1.1131094263163939, 1.5198273114124148, 1.1131094263163939, 1.3045848629913512, 0.9432000528436495, 1.1131094263163939, 0.7928187794082265, 0.9432000528436495, 0.5432504094316501, 0.5432504094316501, 1.3045848629913512, 0.6600817106484301, 1.1131094263163939, 0.5432504094316501, 0.5432504094316501, 1.3045848629913512, 0.5432504094316501, 0.4407235911329617, 1.7612099351945598, 0.7928187794082265, 0.35102911758195016, 0.6600817106484301, 1.1131094263163939, 0.6600817106484301, 0.9432000528436495, 1.1131094263163939, 0.5432504094316501, 2.668716430344202, 1.5198273114124148, 0.5432504094316501, 1.1131094263163939, 0.9432000528436495, 6.2780618556447605, 0.6600817106484301, 1.1131094263163939, 0.4407235911329617, 1.1131094263163939, 0.5432504094316501, 0.6600817106484301, 1.3045848629913512, 0.7928187794082265, 2.668716430344202, 0.6600817106484301, 0.7928187794082265, 0.7928187794082265, 0.7928187794082265, 1.1131094263163939, 0.5432504094316501, 0.6600817106484301, 0.7928187794082265, 0.6600817106484301, 0.7928187794082265, 0.4407235911329617, 0.6600817106484301, 0.4407235911329617, 0.7928187794082265, 1.1131094263163939, 0.5432504094316501, 0.5432504094316501, 0.9432000528436495, 0.9432000528436495, 1.1131094263163939, 0.6600817106484301, 0.5432504094316501, 2.668716430344202, 0.9432000528436495, 0.9432000528436495, 1.1131094263163939, 0.6600817106484301, 0.9432000528436495, 0.5432504094316501, 0.4407235911329617, 0.7928187794082265, 0.4407235911329617, 0.7928187794082265, 0.7928187794082265, 0.6600817106484301, 1.1131094263163939, 1.7612099351945598, 2.0312876589133846, 1.1131094263163939, 0.6600817106484301, 0.9432000528436495, 1.3045848629913512, 1.1131094263163939, 2.0312876589133846, 0.9432000528436495, 0.6600817106484301, 0.9432000528436495, 0.6600817106484301, 0.6600817106484301, 0.6600817106484301, 0.5432504094316501, 0.35102911758195016, 0.7928187794082265, 1.3045848629913512, 1.1131094263163939, 0.5432504094316501, 1.1131094263163939, 1.7612099351945598, 0.9432000528436495, 2.0312876589133846, 0.7928187794082265, 0.6600817106484301, 2.0312876589133846, 1.1131094263163939, 0.4407235911329617, 0.6600817106484301, 1.1131094263163939, 1.3045848629913512, 0.6600817106484301, 1.5198273114124148, 1.1131094263163939, 0.6600817106484301, 0.5432504094316501, 1.1131094263163939, 0.6600817106484301, 0.7928187794082265, 1.1131094263163939, 1.5198273114124148, 0.9432000528436495, 0.9432000528436495, 0.6600817106484301, 1.3045848629913512, 0.4407235911329617, 2.0312876589133846, 0.6600817106484301, 0.7928187794082265, 0.6600817106484301, 1.3045848629913512]
    # spot_weights =[0.37115681925012395, 0.8973806566252908, 1.0441409149317271, 0.6492505531018116, 0.8973806566252908, 0.6492505531018116, 0.5452027843379944, 0.8973806566252908, 1.2079865694275362, 1.2079865694275362, 0.7662133180933878, 0.5452027843379944, 1.8186401643947878, 0.8973806566252908, 0.8973806566252908, 0.7662133180933878, 0.6492505531018116, 1.0441409149317271, 0.37115681925012395, 0.7662133180933878, 2.0680323434660104, 0.8973806566252908, 2.0680323434660104, 1.3905197641719333, 0.45287401617381423, 1.2079865694275362, 0.7662133180933878, 0.7662133180933878, 1.0441409149317271, 0.8973806566252908, 0.5452027843379944, 0.5452027843379944, 1.3905197641719333, 0.5452027843379944, 0.5452027843379944, 0.5452027843379944, 0.7662133180933878, 0.6492505531018116, 1.0441409149317271, 1.2079865694275362, 0.7662133180933878, 0.6492505531018116, 3.3518383788301915, 0.45287401617381423, 0.7662133180933878, 0.5452027843379944, 2.983174023576911, 0.5452027843379944, 0.5452027843379944, 0.7662133180933878, 0.8973806566252908, 2.983174023576911, 0.37115681925012395, 0.29902748466528467, 0.8973806566252908, 1.8186401643947878, 0.6492505531018116, 0.5452027843379944, 0.37115681925012395, 0.8973806566252908, 0.45287401617381423, 0.45287401617381423, 0.5452027843379944, 1.0441409149317271, 0.7662133180933878, 0.7662133180933878, 0.5452027843379944, 0.6492505531018116, 0.6492505531018116, 1.3905197641719333, 2.983174023576911, 0.6492505531018116, 0.5452027843379944, 0.8973806566252908, 1.5934580267032499, 0.45287401617381423, 1.2079865694275362, 0.7662133180933878, 0.7662133180933878, 0.5452027843379944, 0.5452027843379944, 0.5452027843379944, 0.5452027843379944, 0.45287401617381423, 0.37115681925012395, 0.7662133180933878, 0.45287401617381423, 1.0441409149317271, 1.3905197641719333, 1.8186401643947878, 1.5934580267032499, 0.6492505531018116, 1.0441409149317271, 2.343734352768041, 1.0441409149317271, 3.3518383788301915, 0.8973806566252908, 0.5452027843379944, 1.0441409149317271, 0.5452027843379944, 0.7662133180933878, 1.8186401643947878, 0.45287401617381423, 0.5452027843379944, 0.23554134553186165, 1.0441409149317271, 2.343734352768041, 0.37115681925012395, 0.8973806566252908, 1.8186401643947878, 1.3905197641719333, 0.7662133180933878, 1.2079865694275362, 0.8973806566252908, 2.0680323434660104, 1.8186401643947878, 0.7662133180933878, 0.5452027843379944, 1.2079865694275362, 0.5452027843379944, 0.45287401617381423, 1.3905197641719333, 1.0441409149317271, 1.0441409149317271, 0.6492505531018116, 1.0441409149317271, 0.45287401617381423, 0.6492505531018116, 2.983174023576911, 1.2079865694275362, 2.343734352768041, 1.0441409149317271, 0.5452027843379944, 1.0441409149317271, 0.29902748466528467, 0.8973806566252908, 1.2079865694275362, 0.6492505531018116, 2.343734352768041, 1.2079865694275362]
    #107 NVs
    # spot_weights = [1.1403335363025622, 0.5386498469511105, 1.0181733172420984, 0.7065350595959498, 0.8018803616929954, 1.7381214942471155, 0.6189680005910175, 0.8018803616929954, 0.8018803616929954, 0.8018803616929954, 1.2726996107971527, 1.2726996107971527, 1.7381214942471155, 0.6189680005910175, 0.4650799082401989, 0.8018803616929954, 0.5386498469511105, 0.8018803616929954, 1.2726996107971527, 1.0181733172420984, 0.8018803616929954, 0.7065350595959498, 0.8018803616929954, 0.8018803616929954, 0.7065350595959498, 0.6189680005910175, 0.6189680005910175, 1.0181733172420984, 0.9055630595263081, 1.7381214942471155, 1.0181733172420984, 0.7065350595959498, 0.5386498469511105, 0.8018803616929954, 1.7381214942471155, 0.7065350595959498, 0.7065350595959498, 1.5708481060657171, 0.5386498469511105, 0.8018803616929954, 1.0181733172420984, 1.1403335363025622, 0.8018803616929954, 1.0181733172420984, 0.6189680005910175, 1.0181733172420984, 0.7065350595959498, 0.9055630595263081, 0.7065350595959498, 1.0181733172420984, 1.0181733172420984, 0.8018803616929954, 1.0181733172420984, 0.9055630595263081, 0.9055630595263081, 0.7065350595959498, 1.7381214942471155, 1.1403335363025622, 0.6189680005910175, 0.9055630595263081, 1.1403335363025622, 0.7065350595959498, 0.7065350595959498, 0.7065350595959498, 0.8018803616929954, 0.9055630595263081, 1.9185853940314987, 1.0181733172420984, 0.7065350595959498, 1.2726996107971527, 1.5708481060657171, 1.7381214942471155, 1.0181733172420984, 0.6189680005910175, 0.6189680005910175, 0.6189680005910175, 0.9055630595263081, 0.7065350595959498, 0.6189680005910175, 0.8018803616929954, 1.1403335363025622, 1.0181733172420984, 1.0181733172420984, 1.4159622125181186, 1.1403335363025622, 1.1403335363025622, 0.9055630595263081, 0.9055630595263081, 1.2726996107971527, 0.8018803616929954, 0.9055630595263081, 0.6189680005910175, 1.2726996107971527, 1.2726996107971527, 0.7065350595959498, 0.6189680005910175, 0.8018803616929954, 2.322499338808369, 1.2726996107971527, 0.8018803616929954, 1.9185853940314987, 0.9055630595263081, 2.322499338808369, 0.6189680005910175, 2.322499338808369, 1.0181733172420984, 2.1130830433225904]
    # 303 NVs
    # spot_weights = [0.9897519966135784, 0.5479377574317358, 0.9897519966135784, 0.354185196459369, 1.3010058120927683, 0.31544459499106525, 1.5504000820199877, 0.44273849051910824, 1.1893815335351803, 0.8185185332315277, 0.49310810334403304, 0.354185196459369, 0.9897519966135784, 0.49310810334403304, 0.9008067399383006, 1.4211687527567642, 0.8185185332315277, 1.5504000820199877, 0.9897519966135784, 0.8185185332315277, 1.0857907454215747, 1.0857907454215747, 1.0857907454215747, 0.3965262885968151, 1.0857907454215747, 0.9897519966135784, 1.1893815335351803, 0.44273849051910824, 0.9008067399383006, 0.5479377574317358, 0.44273849051910824, 1.1893815335351803, 0.5479377574317358, 1.1893815335351803, 0.28004891593572817, 1.0857907454215747, 0.8185185332315277, 1.0857907454215747, 0.6722733544068324, 1.4211687527567642, 1.4211687527567642, 0.49310810334403304, 1.0857907454215747, 1.0857907454215747, 0.7424722578359433, 0.7424722578359433, 0.8185185332315277, 1.3010058120927683, 0.8185185332315277, 1.0857907454215747, 1.5504000820199877, 0.5479377574317358, 1.4211687527567642, 1.4211687527567642, 1.5504000820199877, 0.28004891593572817, 0.9897519966135784, 1.3010058120927683, 1.5504000820199877, 1.3010058120927683, 1.0857907454215747, 0.6722733544068324, 0.354185196459369, 0.6722733544068324, 0.9897519966135784, 1.5504000820199877, 1.4211687527567642, 0.9008067399383006, 1.4211687527567642, 1.0857907454215747, 0.9897519966135784, 1.3010058120927683, 0.7424722578359433, 0.3965262885968151, 0.7424722578359433, 1.4211687527567642, 0.6722733544068324, 1.0857907454215747, 1.0857907454215747, 0.6722733544068324, 1.4211687527567642, 1.1893815335351803, 0.9897519966135784, 0.5479377574317358, 1.5504000820199877, 0.9008067399383006, 0.9897519966135784, 1.0857907454215747, 0.9897519966135784, 0.44273849051910824, 1.3010058120927683, 1.5504000820199877, 1.4211687527567642, 1.4211687527567642, 0.5479377574317358, 0.7424722578359433, 0.9897519966135784, 0.7424722578359433, 1.4211687527567642, 0.6722733544068324, 0.6722733544068324, 1.3010058120927683, 0.9897519966135784, 1.1893815335351803, 0.44273849051910824, 1.3010058120927683, 0.7424722578359433, 0.5479377574317358, 0.44273849051910824, 0.354185196459369, 1.1893815335351803, 1.1893815335351803, 1.5504000820199877, 0.354185196459369, 1.0857907454215747, 1.0857907454215747, 1.3010058120927683, 0.8185185332315277, 0.6722733544068324, 1.1893815335351803, 0.49310810334403304, 1.4211687527567642, 0.9008067399383006, 0.9008067399383006, 0.354185196459369, 1.4211687527567642, 1.4211687527567642, 1.5504000820199877, 0.3965262885968151, 0.6722733544068324, 1.0857907454215747, 1.4211687527567642, 1.3010058120927683, 0.8185185332315277, 0.6722733544068324, 0.9008067399383006, 0.8185185332315277, 0.9897519966135784, 1.5504000820199877, 1.4211687527567642, 1.0857907454215747, 1.0857907454215747, 0.31544459499106525, 1.3010058120927683, 0.9897519966135784, 1.1893815335351803, 0.44273849051910824, 0.6722733544068324, 1.5504000820199877, 1.1893815335351803, 0.6722733544068324, 1.4211687527567642, 0.44273849051910824, 0.31544459499106525, 1.1893815335351803, 0.8185185332315277, 1.3010058120927683, 1.3010058120927683, 0.9897519966135784, 0.8185185332315277, 1.4211687527567642, 0.7424722578359433, 1.1893815335351803, 1.3010058120927683, 1.4211687527567642, 0.7424722578359433, 1.3010058120927683, 1.4211687527567642, 1.0857907454215747, 1.5504000820199877, 1.5504000820199877, 1.5504000820199877, 0.9897519966135784, 0.6075470758769943, 0.9897519966135784, 0.28004891593572817, 0.7424722578359433, 1.4211687527567642, 0.49310810334403304, 1.0857907454215747, 1.4211687527567642, 0.7424722578359433, 1.3010058120927683, 0.9008067399383006, 0.31544459499106525, 0.44273849051910824, 1.5504000820199877, 0.8185185332315277, 1.5504000820199877, 0.8185185332315277, 0.354185196459369, 0.6075470758769943, 1.5504000820199877, 0.9008067399383006, 1.5504000820199877, 1.3010058120927683, 1.5504000820199877, 0.49310810334403304, 1.3010058120927683, 0.9008067399383006, 0.8185185332315277, 1.4211687527567642, 0.9897519966135784, 1.4211687527567642, 1.4211687527567642, 1.3010058120927683, 0.6075470758769943, 1.3010058120927683, 0.354185196459369, 1.1893815335351803, 1.5504000820199877, 1.4211687527567642, 0.31544459499106525, 0.28004891593572817, 0.6722733544068324, 0.9008067399383006, 1.1893815335351803, 0.31544459499106525, 1.3010058120927683, 0.6722733544068324, 0.9008067399383006, 1.5504000820199877, 0.28004891593572817, 1.4211687527567642, 1.5504000820199877, 1.3010058120927683, 0.9008067399383006, 1.1893815335351803, 1.3010058120927683, 0.354185196459369, 0.44273849051910824, 0.28004891593572817, 0.44273849051910824, 1.5504000820199877, 0.9008067399383006, 1.5504000820199877, 0.28004891593572817, 0.9897519966135784, 1.3010058120927683, 1.5504000820199877, 1.3010058120927683, 1.3010058120927683, 1.5504000820199877, 0.9008067399383006, 0.7424722578359433, 1.5504000820199877, 1.3010058120927683, 1.1893815335351803, 0.28004891593572817, 0.9897519966135784, 1.4211687527567642, 1.3010058120927683, 1.3010058120927683, 1.4211687527567642, 1.0857907454215747, 0.354185196459369, 1.4211687527567642, 1.4211687527567642, 1.5504000820199877, 0.31544459499106525, 1.0857907454215747, 1.3010058120927683, 0.5479377574317358, 0.3965262885968151, 1.3010058120927683, 1.4211687527567642, 1.4211687527567642, 0.8185185332315277, 0.6075470758769943, 0.5479377574317358, 1.3010058120927683, 1.5504000820199877, 1.0857907454215747, 0.8185185332315277, 1.5504000820199877, 1.1893815335351803, 1.5504000820199877, 0.7424722578359433, 0.9008067399383006, 1.5504000820199877, 0.6722733544068324, 1.3010058120927683, 0.8185185332315277, 1.3010058120927683, 1.5504000820199877, 1.5504000820199877, 1.4211687527567642, 1.3010058120927683, 0.8185185332315277, 1.4211687527567642, 1.3010058120927683, 0.8185185332315277, 1.3010058120927683, 0.44273849051910824, 0.6722733544068324, 0.49310810334403304, 0.9897519966135784, 1.1893815335351803, 0.9008067399383006, 0.28004891593572817, 0.354185196459369, 0.9008067399383006, 0.49310810334403304]
    # spot_weights = [0.9649121129602884, 0.53418612046569, 0.9649121129602884, 0.6554012571907534, 1.385501568865291, 1.5114895693004426, 1.2683543669679191, 1.058540569740827, 0.4807325305162245, 0.43162704782340683, 0.4807325305162245, 0.3452961827449534, 0.9649121129602884, 0.4807325305162245, 1.5114895693004426, 1.385501568865291, 0.7979761092676478, 1.5114895693004426, 0.9649121129602884, 0.7979761092676478, 1.058540569740827, 1.058540569740827, 1.058540569740827, 0.3865746371650259, 1.058540569740827, 0.9649121129602884, 1.1595315317029333, 0.43162704782340683, 0.8781991223828668, 0.53418612046569, 0.43162704782340683, 1.1595315317029333, 0.53418612046569, 0.43162704782340683, 0.27302050628070895, 1.058540569740827, 0.7979761092676478, 1.058540569740827, 0.6554012571907534, 1.385501568865291, 1.385501568865291, 1.5114895693004426, 1.058540569740827, 1.058540569740827, 0.7238383732228861, 0.7238383732228861, 0.7979761092676478, 1.2683543669679191, 0.7979761092676478, 1.2683543669679191, 1.5114895693004426, 0.53418612046569, 0.53418612046569, 1.385501568865291, 1.5114895693004426, 0.27302050628070895, 0.9649121129602884, 1.2683543669679191, 0.4807325305162245, 1.2683543669679191, 1.058540569740827, 0.6554012571907534, 0.3452961827449534, 0.6554012571907534, 0.9649121129602884, 1.5114895693004426, 1.385501568865291, 1.385501568865291, 1.385501568865291, 1.058540569740827, 0.9649121129602884, 1.2683543669679191, 0.3865746371650259, 0.3865746371650259, 0.7238383732228861, 1.385501568865291, 0.6554012571907534, 1.058540569740827, 1.058540569740827, 0.6554012571907534, 1.385501568865291, 1.1595315317029333, 0.9649121129602884, 0.53418612046569, 1.385501568865291, 0.8781991223828668, 1.5114895693004426, 1.058540569740827, 0.9649121129602884, 0.43162704782340683, 1.2683543669679191, 1.5114895693004426, 1.385501568865291, 1.5114895693004426, 0.53418612046569, 0.7238383732228861, 1.5114895693004426, 0.7238383732228861, 1.385501568865291, 0.6554012571907534, 0.6554012571907534, 1.2683543669679191, 1.5114895693004426, 1.2683543669679191, 0.43162704782340683, 1.5114895693004426, 0.7238383732228861, 0.53418612046569, 0.3452961827449534, 1.1595315317029333, 1.1595315317029333, 0.307527857196702, 0.27302050628070895, 0.3452961827449534, 1.2683543669679191, 0.6554012571907534, 1.2683543669679191, 1.058540569740827, 0.6554012571907534, 1.1595315317029333, 0.8781991223828668, 1.5114895693004426, 0.8781991223828668, 0.8781991223828668, 0.3452961827449534, 1.385501568865291, 1.385501568865291, 1.5114895693004426, 0.43162704782340683, 0.6554012571907534, 1.058540569740827, 1.385501568865291, 1.2683543669679191, 1.385501568865291, 1.385501568865291, 0.307527857196702, 0.7979761092676478, 0.9649121129602884, 1.5114895693004426, 1.385501568865291, 1.058540569740827, 1.058540569740827, 0.307527857196702, 1.2683543669679191, 0.53418612046569, 1.5114895693004426, 0.43162704782340683, 0.5922994191606492, 1.5114895693004426, 1.2683543669679191, 1.1595315317029333, 1.385501568865291, 0.43162704782340683, 0.307527857196702, 1.1595315317029333, 0.7979761092676478, 1.2683543669679191, 1.2683543669679191, 0.9649121129602884, 0.7979761092676478, 1.385501568865291, 0.7238383732228861, 1.385501568865291, 1.2683543669679191, 1.385501568865291, 1.2683543669679191, 0.307527857196702, 1.385501568865291, 1.058540569740827, 1.5114895693004426, 1.5114895693004426, 1.5114895693004426, 1.058540569740827, 1.1595315317029333, 0.9649121129602884, 0.43162704782340683, 0.27302050628070895, 1.385501568865291, 0.9649121129602884, 1.058540569740827, 1.385501568865291, 1.5114895693004426, 1.2683543669679191, 0.8781991223828668, 1.1595315317029333, 0.43162704782340683, 1.5114895693004426, 0.7979761092676478, 0.9649121129602884, 0.7979761092676478, 0.3452961827449534, 1.2683543669679191, 1.5114895693004426, 0.8781991223828668, 1.5114895693004426, 1.2683543669679191, 1.5114895693004426, 0.4807325305162245, 1.385501568865291, 0.8781991223828668, 1.1595315317029333, 1.385501568865291, 0.5922994191606492, 0.7979761092676478, 1.385501568865291, 1.2683543669679191, 1.058540569740827, 1.2683543669679191, 1.5114895693004426, 1.1595315317029333, 1.5114895693004426, 0.4807325305162245, 0.307527857196702, 0.27302050628070895, 1.2683543669679191, 0.8781991223828668, 1.1595315317029333, 0.307527857196702, 1.385501568865291, 0.6554012571907534, 1.2683543669679191, 1.5114895693004426, 0.27302050628070895, 0.4807325305162245, 1.5114895693004426, 1.1595315317029333, 0.8781991223828668, 1.1595315317029333, 1.2683543669679191, 0.7238383732228861, 0.43162704782340683, 0.27302050628070895, 0.43162704782340683, 1.5114895693004426, 0.6554012571907534, 1.5114895693004426, 0.27302050628070895, 0.9649121129602884, 1.2683543669679191, 1.5114895693004426, 1.2683543669679191, 1.2683543669679191, 1.5114895693004426, 0.8781991223828668, 0.7979761092676478, 1.5114895693004426, 1.2683543669679191, 1.1595315317029333, 0.27302050628070895, 0.9649121129602884, 0.3452961827449534, 1.2683543669679191, 1.2683543669679191, 1.385501568865291, 1.5114895693004426, 0.3452961827449534, 1.385501568865291, 1.5114895693004426, 1.5114895693004426, 0.8781991223828668, 0.4807325305162245, 1.2683543669679191, 0.4807325305162245, 0.3865746371650259, 1.2683543669679191, 0.3452961827449534, 1.385501568865291, 0.7979761092676478, 0.5922994191606492, 1.5114895693004426, 1.5114895693004426, 1.5114895693004426, 1.058540569740827, 0.8781991223828668, 1.5114895693004426, 1.1595315317029333, 1.5114895693004426, 0.7238383732228861, 0.8781991223828668, 1.5114895693004426, 0.6554012571907534, 0.9649121129602884, 1.5114895693004426, 1.5114895693004426, 1.5114895693004426, 1.5114895693004426, 1.385501568865291, 1.2683543669679191, 0.3452961827449534, 1.385501568865291, 1.2683543669679191, 1.5114895693004426, 1.2683543669679191, 0.43162704782340683, 0.4807325305162245, 0.3452961827449534, 1.5114895693004426, 1.1595315317029333, 0.8781991223828668, 0.27302050628070895, 1.1595315317029333, 0.8781991223828668, 0.4807325305162245]
    #203 NVs
    # spot_weights = [0.7876131708746917, 1.1660047878210302, 1.404688812670059, 1.0598286872275273, 1.404688812670059, 0.7876131708746917, 0.4607014848360796, 0.5749613992789493, 0.41071466214095254, 0.710699537137271, 0.6399530826827737, 0.6399530826827737, 0.5749613992789493, 1.0598286872275273, 1.404688812670059, 0.7876131708746917, 1.0598286872275273, 1.1660047878210302, 0.41071466214095254, 0.8711291950446729, 1.1660047878210302, 1.6823798389132838, 0.7876131708746917, 0.41071466214095254, 0.8711291950446729, 1.404688812670059, 0.5153340043421131, 0.9617065223475108, 0.9617065223475108, 0.5749613992789493, 1.404688812670059, 0.5749613992789493, 0.8711291950446729, 0.9617065223475108, 1.0598286872275273, 0.8711291950446729, 0.8711291950446729, 1.0598286872275273, 0.9617065223475108, 0.4607014848360796, 1.2807704498523065, 0.5749613992789493, 0.6399530826827737, 0.4607014848360796, 0.6399530826827737, 0.5153340043421131, 0.5153340043421131, 0.710699537137271, 0.6399530826827737, 1.8374255372721644, 1.1660047878210302, 1.1660047878210302, 0.5749613992789493, 0.7876131708746917, 0.5749613992789493, 0.6399530826827737, 1.2807704498523065, 1.6823798389132838, 0.9617065223475108, 1.404688812670059, 1.1660047878210302, 0.7876131708746917, 1.8374255372721644, 0.6399530826827737, 0.710699537137271, 0.710699537137271, 0.9617065223475108, 2.0041721363878664, 0.7876131708746917, 0.4607014848360796, 0.710699537137271, 0.9617065223475108, 2.0041721363878664, 0.5749613992789493, 0.6399530826827737, 0.710699537137271, 0.710699537137271, 1.8374255372721644, 0.6399530826827737, 0.6399530826827737, 1.404688812670059, 0.5749613992789493, 0.710699537137271, 0.710699537137271, 1.1660047878210302, 1.2807704498523065, 0.9617065223475108, 0.9617065223475108, 0.6399530826827737, 0.5153340043421131, 1.1660047878210302, 1.2807704498523065, 2.0041721363878664, 0.5153340043421131, 0.5153340043421131, 0.710699537137271, 0.4607014848360796, 1.5383515376156156, 0.5749613992789493, 0.9617065223475108, 1.6823798389132838, 1.0598286872275273, 1.2807704498523065, 1.8374255372721644, 0.9617065223475108, 0.6399530826827737, 2.0041721363878664, 0.710699537137271, 1.0598286872275273, 0.710699537137271, 0.41071466214095254, 1.404688812670059, 0.7876131708746917, 1.8374255372721644, 0.3650437776927498, 0.4607014848360796, 2.0041721363878664, 1.1660047878210302, 0.7876131708746917, 0.7876131708746917, 0.6399530826827737, 0.710699537137271, 1.5383515376156156, 0.6399530826827737, 0.5153340043421131, 0.3650437776927498, 0.8711291950446729, 0.4607014848360796, 1.404688812670059, 0.7876131708746917, 1.0598286872275273, 1.2807704498523065, 0.710699537137271, 0.8711291950446729, 1.0598286872275273, 0.8711291950446729, 0.7876131708746917, 0.6399530826827737, 0.8711291950446729, 0.6399530826827737, 0.5749613992789493, 2.0041721363878664, 1.0598286872275273, 0.6399530826827737, 0.4607014848360796, 1.404688812670059, 1.1660047878210302, 0.9617065223475108, 1.8374255372721644, 0.6399530826827737, 1.6823798389132838, 1.0598286872275273, 0.8711291950446729, 1.404688812670059, 0.4607014848360796, 1.8374255372721644, 0.7876131708746917, 0.5153340043421131, 1.5383515376156156, 1.5383515376156156, 0.6399530826827737, 0.9617065223475108, 0.710699537137271, 1.5383515376156156, 1.6823798389132838, 0.6399530826827737, 0.8711291950446729, 0.4607014848360796, 0.4607014848360796, 1.8374255372721644, 1.6823798389132838, 0.7876131708746917, 1.404688812670059, 0.41071466214095254, 0.7876131708746917, 2.0041721363878664, 1.0598286872275273, 1.1660047878210302, 1.2807704498523065, 1.1660047878210302, 1.1660047878210302, 1.8374255372721644, 0.9617065223475108, 0.710699537137271, 1.0598286872275273, 1.404688812670059, 0.7876131708746917, 1.1660047878210302, 1.0598286872275273, 0.5153340043421131, 2.0041721363878664, 1.8374255372721644, 1.8374255372721644, 1.1660047878210302, 1.6823798389132838, 1.6823798389132838, 1.8374255372721644, 0.9617065223475108, 0.5749613992789493, 0.4607014848360796, 1.404688812670059, 0.6399530826827737, 1.5383515376156156]
    #240 NVs
    # spot_weights = [1.6112144565213162, 1.2360349714730405, 0.5694305916816259, 1.2360349714730405, 0.327817895248643, 0.41208001469242406, 1.6112144565213162, 0.6313780830009311, 1.4769140340954565, 0.6313780830009311, 0.6313780830009311, 1.0285749748135498, 0.3680780950925032, 0.7715956992421467, 1.2360349714730405, 0.4601048881869296, 0.6313780830009311, 0.7715956992421467, 1.0285749748135498, 1.2360349714730405, 0.7715956992421467, 1.0285749748135498, 1.4769140340954565, 1.3520377074097054, 0.5124502468424602, 1.0285749748135498, 0.5694305916816259, 1.0285749748135498, 0.5124502468424602, 1.2360349714730405, 0.6986432469373427, 0.5694305916816259, 0.7715956992421467, 0.6313780830009311, 1.6112144565213162, 1.4769140340954565, 0.7715956992421467, 0.5694305916816259, 1.6112144565213162, 0.6986432469373427, 1.1283808392869679, 0.5694305916816259, 0.4601048881869296, 1.3520377074097054, 1.4769140340954565, 1.4769140340954565, 1.2360349714730405, 0.5124502468424602, 1.2360349714730405, 0.6986432469373427, 0.5124502468424602, 0.5694305916816259, 1.2360349714730405, 1.4769140340954565, 0.5124502468424602, 1.1283808392869679, 1.4769140340954565, 0.41208001469242406, 1.0285749748135498, 0.5694305916816259, 0.7715956992421467, 1.6112144565213162, 0.7715956992421467, 1.1283808392869679, 1.1283808392869679, 1.3520377074097054, 0.6313780830009311, 0.8506248864196453, 0.6986432469373427, 0.5694305916816259, 0.7715956992421467, 1.6112144565213162, 0.7715956992421467, 0.327817895248643, 0.327817895248643, 0.5694305916816259, 1.0285749748135498, 0.7715956992421467, 1.1283808392869679, 0.6986432469373427, 0.6313780830009311, 1.1283808392869679, 1.0285749748135498, 0.7715956992421467, 0.6313780830009311, 1.3520377074097054, 0.9361408443873627, 1.2360349714730405, 1.2360349714730405, 1.1283808392869679, 0.5694305916816259, 1.1283808392869679, 0.5124502468424602, 0.5124502468424602, 0.9361408443873627, 1.1283808392869679, 0.8506248864196453, 1.0285749748135498, 1.6112144565213162, 0.7715956992421467, 0.5694305916816259, 1.4769140340954565, 0.5694305916816259, 1.4769140340954565, 1.2360349714730405, 1.1283808392869679, 1.4769140340954565, 0.8506248864196453, 1.3520377074097054, 0.9361408443873627, 1.2360349714730405, 1.6112144565213162, 0.7715956992421467, 0.3680780950925032, 0.6313780830009311, 1.6112144565213162, 1.6112144565213162, 0.7715956992421467, 0.9361408443873627, 0.5124502468424602, 0.5124502468424602, 0.6313780830009311, 1.6112144565213162, 0.5124502468424602, 0.9361408443873627, 0.7715956992421467, 1.0285749748135498, 0.6313780830009311, 0.8506248864196453, 0.6986432469373427, 0.7715956992421467, 0.6313780830009311, 1.3520377074097054, 0.7715956992421467, 1.0285749748135498, 1.2360349714730405, 1.6112144565213162, 0.6986432469373427, 1.1283808392869679, 0.6313780830009311, 0.8506248864196453, 1.6112144565213162, 0.7715956992421467, 0.9361408443873627, 0.5124502468424602, 0.6313780830009311, 0.6313780830009311, 0.8506248864196453, 0.4601048881869296, 0.4601048881869296, 0.8506248864196453, 0.8506248864196453, 1.4769140340954565, 0.3680780950925032, 0.5694305916816259, 0.6313780830009311, 0.3680780950925032, 0.6986432469373427, 1.4769140340954565, 0.6313780830009311, 0.6986432469373427, 1.2360349714730405, 0.41208001469242406, 1.6112144565213162, 1.6112144565213162, 0.9361408443873627, 0.5124502468424602, 1.6112144565213162, 1.6112144565213162, 1.1283808392869679, 1.6112144565213162, 1.0285749748135498, 1.6112144565213162, 1.4769140340954565, 1.6112144565213162, 1.3520377074097054, 0.7715956992421467, 0.6986432469373427, 0.6313780830009311, 0.7715956992421467, 0.5124502468424602, 0.7715956992421467, 1.3520377074097054, 1.3520377074097054, 0.5694305916816259, 1.1283808392869679, 0.41208001469242406, 1.0285749748135498, 0.9361408443873627, 1.2360349714730405, 0.5124502468424602, 0.7715956992421467, 0.8506248864196453, 1.2360349714730405, 1.4769140340954565, 1.4769140340954565, 1.0285749748135498, 1.6112144565213162, 1.6112144565213162, 1.2360349714730405, 1.1283808392869679, 1.6112144565213162, 1.6112144565213162, 1.1283808392869679, 0.9361408443873627, 0.6313780830009311, 0.5694305916816259, 1.6112144565213162, 0.4601048881869296, 1.1283808392869679, 1.3520377074097054, 1.4769140340954565, 0.9361408443873627, 0.6986432469373427, 1.6112144565213162, 1.6112144565213162, 0.6986432469373427, 1.0285749748135498, 1.6112144565213162, 0.7715956992421467, 1.4769140340954565, 1.3520377074097054, 1.4769140340954565, 0.8506248864196453, 1.4769140340954565, 1.6112144565213162, 1.4769140340954565, 1.6112144565213162, 1.4769140340954565, 1.6112144565213162, 1.6112144565213162, 1.4769140340954565, 1.3520377074097054, 1.1283808392869679, 0.5694305916816259, 1.2360349714730405, 1.0285749748135498, 0.7715956992421467, 1.0285749748135498, 1.3520377074097054]
    # 154NVs 
    # spot_weights =[0.34164142204832704, 0.7261380281286083, 0.630297830645985, 0.4688117973244726, 0.5448365060481702, 0.5448365060481702, 1.0864605747523592, 0.4688117973244726, 0.34164142204832704, 0.5448365060481702, 1.0864605747523592, 0.630297830645985, 0.34164142204832704, 0.4688117973244726, 1.0864605747523592, 0.9530888251442647, 0.34164142204832704, 0.7261380281286083, 0.7261380281286083, 0.7261380281286083, 0.5448365060481702, 0.40134982490646764, 2.0052549860487656, 0.24255110026294943, 0.2889385941319108, 0.630297830645985, 0.4688117973244726, 0.4688117973244726, 0.5448365060481702, 0.4688117973244726, 0.4688117973244726, 0.5448365060481702, 0.8333715231138602, 0.630297830645985, 1.0864605747523592, 0.40134982490646764, 0.8333715231138602, 0.630297830645985, 0.9530888251442647, 0.630297830645985, 0.34164142204832704, 1.0864605747523592, 1.782947028139906, 0.8333715231138602, 0.8333715231138602, 2.0052549860487656, 0.4688117973244726, 1.234741719856568, 0.8333715231138602, 1.782947028139906, 2.2501671838163904, 0.8333715231138602, 0.34164142204832704, 2.2501671838163904, 0.8333715231138602, 0.24255110026294943, 0.40134982490646764, 1.0864605747523592, 2.2501671838163904, 0.5448365060481702, 0.34164142204832704, 0.2889385941319108, 1.234741719856568, 0.24255110026294943, 0.20184315551097023, 0.630297830645985, 0.4688117973244726, 2.5195396130182286, 0.40134982490646764, 0.630297830645985, 0.630297830645985, 0.5448365060481702, 0.7261380281286083, 0.630297830645985, 1.782947028139906, 0.34164142204832704, 0.40134982490646764, 0.5448365060481702, 1.3992758240586378, 0.7261380281286083, 2.0052549860487656, 1.5814995084020878, 0.9530888251442647, 2.2501671838163904, 1.234741719856568, 1.5814995084020878, 1.5814995084020878, 2.0052549860487656, 0.8333715231138602, 0.40134982490646764, 0.4688117973244726, 1.0864605747523592, 0.4688117973244726, 0.7261380281286083, 0.5448365060481702, 0.40134982490646764, 0.34164142204832704, 0.7261380281286083, 0.8333715231138602, 0.7261380281286083, 0.40134982490646764, 0.7261380281286083, 1.782947028139906, 0.9530888251442647, 1.0864605747523592, 0.9530888251442647, 0.7261380281286083, 1.3992758240586378, 2.0052549860487656, 1.5814995084020878, 2.2501671838163904, 0.8333715231138602, 0.7261380281286083, 0.5448365060481702, 0.7261380281286083, 2.5195396130182286, 0.8333715231138602, 2.0052549860487656, 1.3992758240586378, 2.5195396130182286, 2.5195396130182286, 0.24255110026294943, 0.9530888251442647, 2.2501671838163904, 2.2501671838163904, 1.234741719856568, 2.2501671838163904, 0.4688117973244726, 0.7261380281286083, 0.630297830645985, 2.2501671838163904, 0.40134982490646764, 0.630297830645985, 1.5814995084020878, 2.2501671838163904, 0.5448365060481702, 2.5195396130182286, 0.7261380281286083, 2.5195396130182286, 0.4688117973244726, 0.40134982490646764, 0.40134982490646764, 1.0864605747523592, 2.5195396130182286, 1.3992758240586378, 1.782947028139906, 0.2889385941319108, 0.630297830645985, 0.34164142204832704, 0.4688117973244726, 2.2501671838163904, 2.5195396130182286, 1.5814995084020878, 1.3992758240586378]
    # 81NVs 
    # spot_weights = [0.42121614724074086, 0.42121614724074086, 0.5913831460454402, 0.28862313859234545, 0.5913831460454402, 0.28862313859234545, 0.5011121111846141, 3.33546719080946, 0.3506943607351744, 0.42121614724074086, 0.5913831460454402, 0.8074680131343877, 0.9357120222839538, 0.5913831460454402, 0.9357120222839538, 0.6931119998796851, 0.5913831460454402, 0.5913831460454402, 1.4178605276059428, 0.9357120222839538, 0.5011121111846141, 0.5011121111846141, 0.8074680131343877, 0.8074680131343877, 1.2393954542202676, 0.42121614724074086, 1.2393954542202676, 1.4178605276059428, 0.42121614724074086, 0.5011121111846141, 0.5913831460454402, 0.5913831460454402, 0.6931119998796851, 0.3506943607351744, 0.5913831460454402, 0.5011121111846141, 0.42121614724074086, 0.3506943607351744, 0.42121614724074086, 0.6931119998796851, 0.6931119998796851, 2.3498308015296367, 0.42121614724074086, 0.5011121111846141, 1.2393954542202676, 0.6931119998796851, 0.8074680131343877, 0.6931119998796851, 0.5011121111846141, 0.28862313859234545, 0.8074680131343877, 0.5913831460454402, 0.8074680131343877, 0.6931119998796851, 2.080273369022277, 1.4178605276059428, 0.8074680131343877, 1.2393954542202676, 1.4178605276059428, 1.2393954542202676, 1.8364393989759817, 1.8364393989759817, 2.3498308015296367, 1.0792014314592837, 0.8074680131343877, 3.33546719080946, 0.6931119998796851, 2.080273369022277, 1.8364393989759817, 1.0792014314592837, 1.8364393989759817, 2.647301638787188, 0.42121614724074086, 1.0792014314592837, 0.6931119998796851, 2.080273369022277, 1.4178605276059428, 1.6162759005803158, 0.6931119998796851, 0.5913831460454402, 3.33546719080946]
    # spot_weights = [0.3864073115397222, 0.37495650962071386, 0.7338916086387363, 0.2517408338123966, 0.8530658578454492, 0.8530658578454492, 0.5330888423260848, 0.5330888423260848, 0.44920201692197953, 0.627623159045835, 0.7338916086387363, 0.8530658578454492, 0.5330888423260848, 0.7338916086387363, 0.9864073115397222, 0.7338916086387363, 0.9864073115397222, 0.7338916086387363, 0.627623159045835, 0.9864073115397222, 0.44920201692197953, 0.627623159045835, 0.7338916086387363, 0.7338916086387363, 0.37495650962071386, 0.9864073115397222, 1.1352719837886882, 0.7338916086387363, 0.9864073115397222, 0.7338916086387363, 0.5330888423260848, 0.2517408338123966, 0.8530658578454492, 1.3011155290068852, 0.37495650962071386, 0.30942221281223403, 0.9864073115397222, 0.627623159045835, 1.3011155290068852, 0.8530658578454492, 0.5330888423260848, 1.9166807594155018, 2.1671743680462847, 0.30942221281223403, 0.7338916086387363, 0.8530658578454492, 0.8530658578454492, 0.627623159045835, 0.627623159045835, 1.1352719837886882, 0.7338916086387363, 0.8530658578454492, 1.1352719837886882, 1.6900913810573335, 1.1352719837886882, 0.627623159045835, 0.627623159045835, 0.9864073115397222, 0.9864073115397222, 1.1352719837886882, 1.9166807594155018, 1.3011155290068852, 0.44920201692197953, 1.4854984351722218, 1.6900913810573335, 1.4854984351722218, 1.1352719837886882, 2.7481478293862844, 2.1671743680462847, 2.1671743680462847, 0.9864073115397222, 1.9166807594155018, 1.3011155290068852, 0.8530658578454492, 1.3011155290068852, 0.5330888423260848, 1.6900913810573335, 2.4436072706524126, 2.1671743680462847, 1.3011155290068852, 1.3011155290068852]
    # spot_weights = [0.4615726572326756, 0.5477696542406199, 0.644907365391167, 0.2586735616036629, 0.754102357423252, 0.754102357423252, 0.8765585637799694, 0.38528249200266196, 0.754102357423252, 0.754102357423252, 1.3369471406329765, 0.644907365391167, 0.754102357423252, 0.644907365391167, 1.3369471406329765, 0.644907365391167, 0.754102357423252, 0.5477696542406199, 0.8765585637799694, 0.3179434365704627, 0.5477696542406199, 0.754102357423252, 0.8765585637799694, 0.754102357423252, 0.8765585637799694, 0.8765585637799694, 0.8765585637799694, 0.754102357423252, 1.013572127349127, 1.013572127349127, 0.8765585637799694, 0.3179434365704627, 1.013572127349127, 0.4615726572326756, 1.166536405668387, 0.3179434365704627, 1.5264077947283905, 0.4615726572326756, 1.013572127349127, 0.8765585637799694, 1.9694645123194414, 2.5109021301300656, 3.168009962338766, 0.38528249200266196, 1.013572127349127, 0.644907365391167, 1.166536405668387, 0.644907365391167, 0.754102357423252, 0.38528249200266196, 0.5477696542406199, 0.754102357423252, 0.5477696542406199, 1.5264077947283905, 1.166536405668387, 1.3369471406329765, 0.754102357423252, 0.8765585637799694, 1.5264077947283905, 1.166536405668387, 1.3369471406329765, 2.823829476033616, 0.8765585637799694, 1.013572127349127, 0.8765585637799694, 1.013572127349127, 1.013572127349127, 1.166536405668387, 2.2268565012240553, 1.166536405668387, 0.5477696542406199, 1.5264077947283905, 0.4615726572326756, 1.9694645123194414, 0.8765585637799694, 1.013572127349127, 0.754102357423252, 1.166536405668387, 1.7366350557953285, 1.3369471406329765, 2.823829476033616]
    # spot_weights = [0.5134190550128265, 0.6092981762200722, 0.7173469331894057, 0.4285595558085198, 0.8388073116211925, 0.8388073116211925, 0.6092981762200722, 0.4285595558085198, 0.7173469331894057, 0.8388073116211925, 1.4871204495977468, 0.7173469331894057, 0.8388073116211925, 0.7173469331894057, 1.4871204495977468, 0.7173469331894057, 0.8388073116211925, 0.6092981762200722, 0.9750184774321442, 0.3536566046399283, 0.6092981762200722, 0.7173469331894057, 0.9750184774321442, 0.8388073116211925, 0.9750184774321442, 0.9750184774321442, 0.9750184774321442, 0.8388073116211925, 1.1274221634593171, 0.9750184774321442, 0.5134190550128265, 0.3536566046399283, 1.1274221634593171, 0.5134190550128265, 1.2975682368776233, 0.3536566046399283, 0.8388073116211925, 0.5134190550128265, 1.1274221634593171, 0.9750184774321442, 0.8388073116211925, 0.8388073116211925, 0.9750184774321442, 0.4285595558085198, 0.8388073116211925, 0.7173469331894057, 1.2975682368776233, 0.7173469331894057, 0.8388073116211925, 0.4285595558085198, 0.6092981762200722, 0.6092981762200722, 0.6092981762200722, 1.6978623738940664, 1.2975682368776233, 1.4871204495977468, 0.8388073116211925, 0.8388073116211925, 1.6978623738940664, 1.2975682368776233, 0.8388073116211925, 3.1410176456178296, 0.9750184774321442, 1.1274221634593171, 0.9750184774321442, 1.1274221634593171, 1.1274221634593171, 1.2975682368776233, 2.4769893592966636, 1.2975682368776233, 0.6092981762200722, 1.6978623738940664, 0.5134190550128265, 2.190685676354147, 0.9750184774321442, 1.1274221634593171, 0.8388073116211925, 1.2975682368776233, 1.931703525495282, 1.4871204495977468, 3.1410176456178296]
    # spot_weights = [1.2664167231718393, 0.7864630233619618, 0.6521867338939066, 0.6521867338939066, 0.6521867338939066, 1.0115526919456033, 1.358248768031823, 1.093124177283889, 0.7177849350991363, 0.9332897460905698, 1.5525590033596701, 0.6521867338939066, 0.8582788345786523, 0.8582788345786523, 1.1780602919181549, 1.2664167231718393, 0.7864630233619618, 0.7864630233619618, 1.1780602919181549, 0.7864630233619618, 0.9332897460905698, 0.7177849350991363, 0.6521867338939066, 0.8582788345786523, 0.7177849350991363, 1.2664167231718393, 0.6521867338939066, 1.1780602919181549, 1.093124177283889, 0.8582788345786523, 1.8714526708743895, 0.6521867338939066, 0.6521867338939066, 0.8582788345786523, 1.0115526919456033, 0.9332897460905698, 0.7864630233619618, 1.093124177283889, 0.7864630233619618, 1.453611344667083, 1.358248768031823, 0.6521867338939066, 1.093124177283889, 1.453611344667083, 1.093124177283889, 0.6521867338939066, 0.7177849350991363, 1.1780602919181549, 0.7864630233619618, 1.093124177283889, 0.9332897460905698, 0.7864630233619618, 0.7864630233619618, 1.9852791559528724, 1.093124177283889, 0.6521867338939066, 0.7177849350991363, 0.7864630233619618, 1.093124177283889, 0.7864630233619618, 0.7177849350991363, 0.7864630233619618, 1.453611344667083, 0.7177849350991363, 0.8582788345786523, 1.358248768031823, 1.453611344667083, 0.7177849350991363, 0.8582788345786523, 0.7864630233619618, 1.2664167231718393, 1.1780602919181549, 0.7864630233619618, 1.1780602919181549, 0.7177849350991363, 0.7864630233619618, 1.0115526919456033, 0.7177849350991363, 0.7177849350991363, 1.0115526919456033, 1.0115526919456033, 0.6521867338939066, 1.9852791559528724, 1.9852791559528724, 1.358248768031823, 1.0115526919456033, 0.8582788345786523, 0.8582788345786523, 0.8582788345786523, 0.9332897460905698, 1.0115526919456033, 0.7177849350991363, 0.8582788345786523, 0.6521867338939066, 0.9332897460905698, 0.7864630233619618, 0.8582788345786523, 0.9332897460905698, 1.358248768031823, 0.6521867338939066, 0.6521867338939066, 1.2664167231718393, 0.6521867338939066, 0.6521867338939066, 0.7177849350991363, 1.8714526708743895, 0.9332897460905698, 0.7864630233619618, 1.761425990415344, 0.8582788345786523, 1.0115526919456033, 0.7177849350991363, 0.8582788345786523, 1.0115526919456033, 0.6521867338939066, 1.5525590033596701, 0.6521867338939066, 1.8714526708743895, 1.1780602919181549, 1.5525590033596701, 1.0115526919456033, 1.1780602919181549, 1.1780602919181549, 0.6521867338939066, 0.6521867338939066, 0.9332897460905698, 0.7177849350991363, 0.8582788345786523, 1.5525590033596701, 0.7177849350991363, 1.0115526919456033, 0.7177849350991363, 0.7177849350991363, 1.2664167231718393, 0.6521867338939066, 0.9332897460905698, 0.9332897460905698, 1.1780602919181549, 1.093124177283889, 0.7177849350991363, 0.7864630233619618, 1.1780602919181549, 0.7177849350991363, 0.7177849350991363, 1.1780602919181549, 1.0115526919456033, 0.7864630233619618, 0.7864630233619618, 1.5525590033596701, 0.8582788345786523, 1.093124177283889, 0.6521867338939066, 0.6521867338939066, 1.0115526919456033, 0.7177849350991363, 0.7177849350991363, 0.8582788345786523, 1.093124177283889, 1.0115526919456033, 0.7177849350991363, 0.9332897460905698, 1.453611344667083, 0.7177849350991363, 0.8582788345786523, 1.6551459368900925, 0.9332897460905698, 1.093124177283889, 1.453611344667083, 0.6521867338939066, 0.7177849350991363, 0.6521867338939066, 0.8582788345786523, 1.1780602919181549, 1.0115526919456033, 0.7177849350991363, 0.7864630233619618, 1.1780602919181549, 0.9332897460905698, 1.093124177283889, 1.453611344667083, 1.1780602919181549, 0.8582788345786523, 0.7864630233619618, 0.8582788345786523, 0.6521867338939066, 0.9332897460905698, 0.7864630233619618, 1.358248768031823, 1.0115526919456033, 0.7177849350991363, 1.1780602919181549, 0.9332897460905698, 0.9332897460905698, 0.7864630233619618, 0.9332897460905698, 1.2664167231718393, 1.453611344667083, 0.6521867338939066, 0.7177849350991363, 1.761425990415344, 1.1780602919181549, 1.1780602919181549, 0.7864630233619618, 0.7864630233619618, 0.8582788345786523, 0.7864630233619618, 0.7177849350991363, 0.7864630233619618, 0.8582788345786523, 1.8714526708743895, 1.0115526919456033, 0.7864630233619618, 0.8582788345786523, 1.453611344667083, 1.093124177283889, 1.358248768031823, 0.8582788345786523, 0.9332897460905698, 0.7864630233619618, 1.0115526919456033, 0.7177849350991363, 0.8582788345786523, 0.6521867338939066, 0.8582788345786523, 1.761425990415344, 0.8582788345786523, 0.6521867338939066, 1.1780602919181549, 0.8582788345786523, 0.7864630233619618, 0.9332897460905698, 0.6521867338939066, 0.9332897460905698, 1.453611344667083, 0.7864630233619618, 0.7864630233619618, 0.9332897460905698, 0.7177849350991363, 0.7177849350991363, 1.9852791559528724, 0.7864630233619618, 0.9332897460905698, 1.2664167231718393, 0.7177849350991363, 0.9332897460905698, 1.2664167231718393, 1.0115526919456033, 1.093124177283889, 0.9332897460905698, 0.9332897460905698, 0.7177849350991363, 0.7177849350991363, 1.093124177283889, 0.7177849350991363, 1.358248768031823, 1.358248768031823, 0.7177849350991363, 1.453611344667083, 0.9332897460905698, 0.7864630233619618, 0.9332897460905698, 1.453611344667083, 0.9332897460905698, 1.093124177283889, 1.1780602919181549, 0.9332897460905698, 1.1780602919181549, 0.6521867338939066, 1.0115526919456033, 0.9332897460905698, 1.1780602919181549, 0.9332897460905698, 0.9332897460905698, 0.7864630233619618, 0.7177849350991363, 1.1780602919181549, 1.0115526919456033, 0.7864630233619618, 1.0115526919456033, 1.1780602919181549, 0.6521867338939066, 1.453611344667083, 0.9332897460905698, 1.358248768031823, 0.7864630233619618, 0.7864630233619618, 1.1780602919181549, 1.1780602919181549, 0.7864630233619618, 1.0115526919456033, 0.9332897460905698, 1.2664167231718393, 1.5525590033596701, 0.7864630233619618, 1.761425990415344, 1.0115526919456033, 0.9332897460905698, 1.0115526919456033, 0.6521867338939066, 1.1780602919181549, 0.7864630233619618, 1.093124177283889, 1.093124177283889, 0.7864630233619618, 0.8582788345786523, 0.7864630233619618, 0.7177849350991363, 1.761425990415344, 0.8582788345786523, 0.7177849350991363, 1.0115526919456033, 1.0115526919456033, 1.093124177283889, 0.7864630233619618, 1.1780602919181549, 1.1780602919181549, 0.8582788345786523, 1.0115526919456033, 0.8582788345786523, 1.358248768031823, 1.453611344667083, 1.2664167231718393, 1.358248768031823, 1.2664167231718393, 1.0115526919456033, 1.2664167231718393, 1.093124177283889, 0.7177849350991363, 0.9332897460905698, 0.9332897460905698, 0.9332897460905698, 0.6521867338939066, 1.093124177283889, 0.9332897460905698, 1.0115526919456033, 1.0115526919456033, 1.6551459368900925, 1.093124177283889, 1.453611344667083, 1.6551459368900925, 0.7177849350991363, 0.8582788345786523, 0.7177849350991363, 0.9332897460905698, 1.2664167231718393, 0.6521867338939066, 0.9332897460905698, 1.2664167231718393, 1.093124177283889, 1.5525590033596701, 1.2664167231718393, 1.0115526919456033, 0.7864630233619618, 0.7864630233619618, 0.6521867338939066, 1.093124177283889, 0.7864630233619618, 0.7177849350991363, 1.1780602919181549, 0.9332897460905698, 1.093124177283889, 1.2664167231718393, 0.8582788345786523, 1.0115526919456033, 0.8582788345786523, 0.8582788345786523, 1.9852791559528724, 1.2664167231718393, 1.0115526919456033, 0.8582788345786523, 0.7864630233619618, 0.8582788345786523, 1.1780602919181549, 1.0115526919456033, 0.9332897460905698, 1.358248768031823, 1.8714526708743895, 0.7864630233619618, 0.7864630233619618, 1.358248768031823, 1.2664167231718393, 1.093124177283889, 1.5525590033596701, 1.2664167231718393, 0.8582788345786523]
    # spot_weights = [0.7926082204227569, 0.7926082204227569, 1.5025377572410534, 1.411427931183718, 0.9296281666964628, 0.9296281666964628, 0.9296281666964628, 0.607864186216155, 1.3234840756841384, 0.7283042341754292, 0.607864186216155, 0.7926082204227569, 1.0024406500706382, 1.1569093407770477, 0.607864186216155, 1.3234840756841384, 0.7926082204227569, 1.1569093407770477, 1.1569093407770477, 1.0024406500706382, 0.7926082204227569, 1.0781852401000132, 0.9296281666964628, 1.411427931183718, 0.9296281666964628, 0.9296281666964628, 0.8597000513644175, 0.9296281666964628, 1.411427931183718, 1.3234840756841384, 0.7926082204227569, 0.8597000513644175, 1.0781852401000132, 0.9296281666964628, 1.0781852401000132, 1.0024406500706382, 1.0024406500706382, 0.6667392852401665, 0.7926082204227569, 1.5968594233089763, 1.3234840756841384, 0.551629356600995, 0.7926082204227569, 1.0024406500706382, 0.8597000513644175, 0.607864186216155, 0.7926082204227569, 1.3234840756841384, 0.6667392852401665, 1.238660031348102, 1.0781852401000132, 1.3234840756841384, 0.7926082204227569, 1.5968594233089763, 0.7283042341754292, 0.8597000513644175, 0.6667392852401665, 0.7283042341754292, 0.7283042341754292, 0.607864186216155, 0.6667392852401665, 1.411427931183718, 0.607864186216155, 0.607864186216155, 0.607864186216155, 0.551629356600995, 1.694438516584032, 1.1569093407770477, 0.6667392852401665, 1.0024406500706382, 1.1569093407770477, 1.694438516584032, 1.0024406500706382, 1.238660031348102, 0.7926082204227569, 0.7283042341754292, 0.7926082204227569, 1.0781852401000132, 1.0781852401000132, 1.238660031348102, 0.551629356600995, 0.7283042341754292, 1.3234840756841384, 1.5968594233089763, 0.6667392852401665, 1.0024406500706382, 0.7926082204227569, 1.238660031348102, 0.7283042341754292, 1.1569093407770477, 0.8597000513644175, 1.411427931183718, 1.694438516584032, 1.694438516584032, 1.694438516584032, 0.607864186216155, 0.9296281666964628, 0.9296281666964628, 1.1569093407770477, 0.7283042341754292, 0.551629356600995, 1.1569093407770477, 0.8597000513644175, 1.0781852401000132, 0.8597000513644175, 1.0781852401000132, 1.0024406500706382, 1.0024406500706382, 1.238660031348102, 0.8597000513644175, 0.607864186216155, 0.607864186216155, 0.7283042341754292, 1.0781852401000132, 0.551629356600995, 1.1569093407770477, 0.7283042341754292, 0.9296281666964628, 0.9296281666964628, 1.411427931183718, 0.9296281666964628, 1.3234840756841384, 0.607864186216155, 0.8597000513644175, 0.6667392852401665, 0.7926082204227569, 0.7926082204227569, 0.9296281666964628, 1.0781852401000132, 1.5025377572410534, 0.6667392852401665, 1.3234840756841384, 0.8597000513644175, 1.5968594233089763, 0.8597000513644175, 0.7926082204227569, 1.411427931183718, 1.0024406500706382, 0.6667392852401665, 0.6667392852401665, 1.694438516584032, 0.7926082204227569, 1.5968594233089763, 0.7926082204227569, 1.0024406500706382, 1.694438516584032, 0.607864186216155, 1.0781852401000132, 0.9296281666964628, 1.238660031348102, 1.0781852401000132, 0.607864186216155, 0.7283042341754292, 1.238660031348102, 0.6667392852401665, 0.7283042341754292, 0.8597000513644175, 1.0781852401000132, 1.238660031348102, 0.7283042341754292, 1.0024406500706382, 0.607864186216155, 0.6667392852401665, 0.7926082204227569, 1.0781852401000132, 0.9296281666964628, 0.6667392852401665, 1.694438516584032, 1.5968594233089763, 0.7926082204227569, 0.551629356600995, 0.6667392852401665, 1.0781852401000132, 0.607864186216155, 0.9296281666964628, 1.238660031348102, 1.3234840756841384, 1.0781852401000132, 0.7926082204227569, 1.3234840756841384, 1.3234840756841384, 1.238660031348102, 1.1569093407770477, 1.411427931183718, 0.6667392852401665, 1.1569093407770477, 1.0781852401000132, 1.238660031348102, 1.0024406500706382, 0.6667392852401665, 0.9296281666964628, 1.0024406500706382, 0.9296281666964628, 0.9296281666964628, 0.8597000513644175, 1.3234840756841384, 0.6667392852401665, 0.9296281666964628, 0.8597000513644175, 0.9296281666964628, 1.238660031348102, 0.6667392852401665, 0.7283042341754292, 1.0781852401000132, 1.5025377572410534, 0.6667392852401665, 0.607864186216155, 0.9296281666964628, 0.9296281666964628, 1.0781852401000132, 1.411427931183718, 1.1569093407770477, 0.7283042341754292, 1.1569093407770477, 1.0781852401000132, 1.5968594233089763, 0.607864186216155, 1.0024406500706382, 1.0781852401000132, 0.551629356600995, 0.6667392852401665, 1.0024406500706382, 0.7926082204227569, 1.3234840756841384, 0.9296281666964628, 0.6667392852401665, 1.411427931183718, 1.5968594233089763, 1.0024406500706382, 0.7283042341754292, 0.9296281666964628, 1.0024406500706382, 1.0024406500706382, 1.694438516584032, 1.0024406500706382, 0.7926082204227569, 0.9296281666964628, 0.7283042341754292, 0.8597000513644175, 1.5025377572410534, 1.5968594233089763, 1.694438516584032, 0.9296281666964628, 0.9296281666964628, 0.607864186216155, 0.8597000513644175, 1.0024406500706382, 0.7926082204227569, 1.0024406500706382, 1.1569093407770477, 0.6667392852401665, 0.6667392852401665, 0.8597000513644175, 0.7926082204227569, 0.607864186216155, 1.1569093407770477, 1.694438516584032, 1.411427931183718, 0.7283042341754292, 0.7283042341754292, 0.7926082204227569, 1.238660031348102, 0.8597000513644175, 1.238660031348102, 0.6667392852401665, 1.0024406500706382, 0.9296281666964628, 1.0024406500706382, 0.607864186216155, 0.9296281666964628, 1.1569093407770477, 1.1569093407770477, 0.6667392852401665, 0.8597000513644175, 0.7283042341754292, 1.0024406500706382, 1.411427931183718, 0.7926082204227569, 0.6667392852401665, 0.8597000513644175, 0.6667392852401665, 1.3234840756841384, 1.238660031348102, 0.607864186216155, 1.3234840756841384, 1.0024406500706382, 0.7283042341754292, 1.694438516584032, 0.6667392852401665, 0.9296281666964628, 1.5968594233089763, 1.5025377572410534, 0.9296281666964628, 1.238660031348102, 1.5968594233089763, 0.7926082204227569, 1.0024406500706382, 1.1569093407770477, 0.6667392852401665, 1.3234840756841384, 1.5025377572410534, 0.9296281666964628, 0.9296281666964628, 0.7926082204227569, 1.1569093407770477, 1.411427931183718, 1.0024406500706382, 0.607864186216155, 0.7283042341754292, 1.694438516584032, 0.8597000513644175, 1.0024406500706382, 0.9296281666964628, 0.551629356600995, 0.8597000513644175, 0.9296281666964628, 0.9296281666964628, 0.9296281666964628, 0.7926082204227569, 0.9296281666964628, 1.694438516584032, 1.238660031348102, 1.238660031348102, 1.0024406500706382, 0.9296281666964628, 1.0781852401000132, 1.3234840756841384, 1.1569093407770477, 0.7283042341754292, 0.7926082204227569, 1.0024406500706382, 0.7926082204227569, 1.0781852401000132, 1.5025377572410534, 0.7926082204227569, 0.8597000513644175, 0.7283042341754292, 1.0781852401000132, 1.411427931183718, 1.5025377572410534, 0.8597000513644175, 0.8597000513644175, 0.8597000513644175, 0.8597000513644175, 0.8597000513644175, 0.607864186216155, 0.7926082204227569, 1.5968594233089763, 0.9296281666964628, 0.6667392852401665, 0.9296281666964628, 0.551629356600995, 0.551629356600995, 0.9296281666964628, 1.1569093407770477, 0.7283042341754292, 1.0781852401000132, 1.5968594233089763, 0.8597000513644175, 0.7926082204227569, 0.8597000513644175, 1.0024406500706382, 0.7283042341754292, 1.0024406500706382, 1.238660031348102, 0.7926082204227569, 1.694438516584032, 1.5025377572410534, 0.9296281666964628, 1.1569093407770477, 0.607864186216155, 0.7926082204227569, 0.7926082204227569, 1.0781852401000132, 1.0024406500706382, 0.7283042341754292, 1.5968594233089763, 1.0781852401000132, 1.5025377572410534, 1.3234840756841384, 1.238660031348102, 1.3234840756841384, 1.411427931183718, 0.8597000513644175, 1.1569093407770477]
    spot_weights = [0.7639806329281399, 0.6941606174540103, 0.8370787529549714, 0.9933550511548964, 0.8370787529549714, 0.6941606174540103, 0.9135165356732688, 0.7639806329281399, 0.6941606174540103, 1.6524796663239836, 1.076654897648458, 0.8370787529549714, 0.7639806329281399, 1.1634762168908646, 0.9933550511548964, 2.113049120896413, 0.8370787529549714, 0.6941606174540103, 1.5471638659801386, 0.6941606174540103, 0.6941606174540103, 0.7639806329281399, 1.1634762168908646, 0.6941606174540103, 1.2538787085616896, 1.2538787085616896, 0.8370787529549714, 1.1634762168908646, 0.8370787529549714, 0.7639806329281399, 0.6941606174540103, 1.076654897648458, 1.7616689604652773, 1.1634762168908646, 0.9135165356732688, 1.5471638659801386, 0.9135165356732688, 1.076654897648458, 0.6941606174540103, 0.9135165356732688, 1.1634762168908646, 0.9933550511548964, 1.9918969123978685, 0.6941606174540103, 0.9933550511548964, 1.874789058964759, 0.8370787529549714, 0.6941606174540103, 0.9933550511548964, 0.9933550511548964, 0.8370787529549714, 0.9933550511548964, 0.8370787529549714, 1.5471638659801386, 0.6941606174540103, 0.6941606174540103, 0.9135165356732688, 0.6941606174540103, 0.6941606174540103, 1.445663878876896, 0.9135165356732688, 0.9135165356732688, 0.7639806329281399, 1.076654897648458, 0.9135165356732688, 0.8370787529549714, 0.7639806329281399, 0.9135165356732688, 0.7639806329281399, 0.9933550511548964, 1.076654897648458, 0.9933550511548964, 0.7639806329281399, 0.9933550511548964, 0.8370787529549714, 0.8370787529549714, 1.076654897648458, 0.8370787529549714, 0.8370787529549714, 0.7639806329281399, 1.445663878876896, 0.9933550511548964, 1.9918969123978685, 0.9933550511548964, 0.8370787529549714, 1.5471638659801386, 1.1634762168908646, 0.8370787529549714, 0.6941606174540103, 0.7639806329281399, 0.9933550511548964, 0.8370787529549714, 0.9135165356732688, 0.7639806329281399, 1.2538787085616896, 1.5471638659801386, 0.6941606174540103, 0.9933550511548964, 0.8370787529549714, 0.8370787529549714, 0.8370787529549714, 1.076654897648458, 1.9918969123978685, 0.7639806329281399, 0.8370787529549714, 0.8370787529549714, 0.8370787529549714, 1.076654897648458, 0.6941606174540103, 1.076654897648458, 0.7639806329281399, 0.9933550511548964, 1.076654897648458, 1.445663878876896, 0.7639806329281399, 0.6941606174540103, 1.2538787085616896, 0.8370787529549714, 1.445663878876896, 0.9933550511548964, 0.8370787529549714, 1.1634762168908646, 2.113049120896413, 0.6941606174540103, 0.9135165356732688, 1.076654897648458, 0.8370787529549714, 1.076654897648458, 0.9135165356732688, 0.6941606174540103, 0.7639806329281399, 0.9933550511548964, 0.7639806329281399, 1.076654897648458, 1.076654897648458, 0.7639806329281399, 0.8370787529549714, 0.8370787529549714, 0.9135165356732688, 0.9933550511548964, 1.076654897648458, 0.9933550511548964, 0.9135165356732688, 1.5471638659801386, 0.8370787529549714, 0.7639806329281399, 0.7639806329281399, 0.6941606174540103, 1.1634762168908646, 0.9135165356732688, 1.3479216439475352, 0.6941606174540103, 1.076654897648458, 0.8370787529549714, 0.9933550511548964, 0.8370787529549714, 1.076654897648458, 0.9135165356732688, 1.2538787085616896, 0.9933550511548964, 0.9135165356732688, 1.076654897648458, 0.8370787529549714, 0.9135165356732688, 0.6941606174540103, 0.8370787529549714, 0.7639806329281399, 0.9933550511548964, 1.076654897648458, 1.5471638659801386, 0.6941606174540103, 0.9135165356732688, 1.1634762168908646, 0.7639806329281399, 0.9135165356732688, 1.3479216439475352, 0.9135165356732688, 0.8370787529549714, 0.7639806329281399, 1.076654897648458, 0.6941606174540103, 0.8370787529549714, 0.6941606174540103, 0.6941606174540103, 0.7639806329281399, 1.445663878876896, 1.445663878876896, 0.7639806329281399, 0.8370787529549714, 1.076654897648458, 0.9135165356732688, 1.6524796663239836, 0.7639806329281399, 1.2538787085616896, 0.7639806329281399, 0.9135165356732688, 0.7639806329281399, 0.6941606174540103, 0.6941606174540103, 0.9135165356732688, 0.9933550511548964, 1.1634762168908646, 0.9933550511548964, 1.3479216439475352, 0.9135165356732688, 1.5471638659801386, 0.8370787529549714, 0.9933550511548964, 0.8370787529549714, 0.9135165356732688, 0.9933550511548964, 1.1634762168908646, 0.6941606174540103, 0.6941606174540103, 0.6941606174540103, 0.9933550511548964, 0.9933550511548964, 1.076654897648458, 1.3479216439475352, 0.9135165356732688, 1.2538787085616896, 0.9933550511548964, 0.6941606174540103, 0.9135165356732688, 0.9933550511548964, 0.9933550511548964, 1.076654897648458, 1.2538787085616896, 0.7639806329281399, 1.1634762168908646, 1.1634762168908646, 1.874789058964759, 0.7639806329281399, 1.2538787085616896, 0.9933550511548964, 0.9135165356732688, 1.076654897648458, 0.6941606174540103, 0.8370787529549714, 0.6941606174540103, 0.8370787529549714, 0.7639806329281399, 0.8370787529549714, 0.9135165356732688, 1.076654897648458, 1.9918969123978685, 0.9933550511548964, 0.9135165356732688, 1.445663878876896, 0.7639806329281399, 0.9933550511548964, 0.9135165356732688, 1.1634762168908646, 1.1634762168908646, 1.1634762168908646, 1.7616689604652773, 1.076654897648458, 0.8370787529549714, 1.076654897648458, 1.076654897648458, 0.8370787529549714, 1.076654897648458, 1.1634762168908646, 1.2538787085616896, 0.8370787529549714, 0.7639806329281399, 0.9933550511548964, 0.8370787529549714, 0.9135165356732688, 0.7639806329281399, 0.9135165356732688, 1.874789058964759, 1.2538787085616896, 0.9135165356732688, 0.9933550511548964, 1.1634762168908646, 0.9135165356732688, 1.1634762168908646, 0.8370787529549714, 1.3479216439475352, 0.6941606174540103, 0.9933550511548964, 1.076654897648458, 0.9135165356732688, 1.2538787085616896, 0.9933550511548964, 1.2538787085616896, 1.1634762168908646, 0.6941606174540103, 0.8370787529549714, 0.9933550511548964, 0.6941606174540103, 1.076654897648458, 0.7639806329281399, 1.2538787085616896, 0.9135165356732688, 0.7639806329281399, 1.1634762168908646, 0.7639806329281399, 0.9933550511548964, 0.6941606174540103, 0.9933550511548964, 1.445663878876896, 0.9135165356732688, 1.2538787085616896, 1.076654897648458, 1.445663878876896, 0.9933550511548964, 0.9933550511548964, 0.8370787529549714, 0.7639806329281399, 1.076654897648458, 0.9135165356732688, 1.874789058964759, 0.9135165356732688, 0.6941606174540103, 1.076654897648458, 1.1634762168908646, 0.8370787529549714, 0.8370787529549714, 2.113049120896413, 1.3479216439475352, 0.9135165356732688, 1.076654897648458, 0.9135165356732688, 0.7639806329281399, 0.8370787529549714, 0.6941606174540103, 1.076654897648458, 0.7639806329281399, 0.7639806329281399, 1.076654897648458, 0.6941606174540103, 1.2538787085616896, 1.2538787085616896, 1.445663878876896, 0.8370787529549714]
    # pol_durs = [1048, 1048, 1940, 1940, 344, 344, 464, 464, 1940, 1940, 1940, 1940, 348, 348, 1940, 1940, 284, 284, 1940, 1940, 1300, 1300, 812, 812, 292, 292, 344, 344, 284, 284, 1940, 1940, 1940, 1940, 540, 540, 1800, 1800, 1940, 1940, 480, 480, 272, 272, 312, 312, 812, 812, 1940, 1940, 704, 704, 296, 296, 1940, 1940, 1348, 1348, 292, 292, 492, 492, 544, 544, 1940, 1940, 256, 256, 428, 428, 436, 436, 692, 692, 1940, 1940, 296, 296, 1164, 1164, 976, 976, 1004, 1004, 696, 696, 476, 476, 416, 416, 1804, 1804, 224, 224, 592, 592, 1940, 1940, 636, 636, 760, 760, 296, 296, 516, 516, 880, 880, 1940, 1940, 552, 552, 1940, 1940, 1940, 1940, 1120, 1120, 1940, 1940, 720, 720, 328, 328, 1308, 1308, 504, 504, 1940, 1940, 344, 344, 420, 420, 1940, 1940, 336, 336, 256, 256, 1940, 1940, 500, 500, 1940, 1940, 696, 696, 208, 208, 1516, 1516, 332, 332, 468, 468, 1176, 1176, 1940, 1940, 1940, 1940, 684, 684, 1632, 1632, 1940, 1940, 732, 732, 668, 668, 316, 316, 828, 828, 1940, 1940, 1940, 1940, 1940, 1940, 344, 344, 604, 604, 460, 460, 604, 604, 268, 268, 460, 460, 576, 576, 1076, 1076, 308, 308, 360, 360, 1616, 1616, 388, 388, 940, 940, 492, 492, 688, 688, 248, 248, 304, 304, 624, 624, 868, 868, 344, 344, 624, 624, 580, 580, 1940, 1940, 1252, 1252, 1596, 1596, 500, 500, 516, 516, 336, 336, 660, 660, 1940, 1940, 476, 476, 700, 700, 584, 584, 1940, 1940, 1940, 1940, 736, 736, 436, 436, 1940, 1940, 524, 524, 492, 492, 408, 408, 364, 364, 1940, 1940, 1940, 1940, 892, 892, 456, 456, 1940, 1940, 1940, 1940, 272, 272, 500, 500, 1024, 1024, 1312, 1312, 1940, 1940, 1940, 1940, 320, 320, 584, 584, 1364, 1364, 1100, 1100, 344, 344, 580, 580, 1940, 1940, 820, 820, 436, 436, 284, 284, 1716, 1716, 260, 260, 1092, 1092, 440, 440, 336, 336, 652, 652, 1036, 1036, 748, 748, 1044, 1044, 660, 660, 1940, 1940, 660, 660, 1940, 1940, 292, 292, 600, 600, 924, 924, 812, 812, 460, 460, 1456, 1456, 872, 872, 584, 584, 656, 656, 848, 848, 972, 972, 1940, 1940, 348, 348, 460, 460, 1940, 1940, 1220, 1220, 1940, 1940, 620, 620, 832, 832, 444, 444, 1940, 1940, 304, 304, 556, 556, 812, 812, 420, 420, 1468, 1468, 876, 876, 704, 704, 360, 360, 604, 604, 668, 668, 916, 916, 812, 812, 436, 436, 812, 812, 1032, 1032, 1940, 1940, 540, 540, 1940, 1940, 1084, 1084, 652, 652, 1940, 1940, 400, 400, 1896, 1896, 844, 844, 1620, 1620, 796, 796, 1940, 1940, 1940, 1940, 752, 752, 404, 404, 1904, 1904, 1308, 1308, 404, 404, 1940, 1940, 360, 360, 576, 576, 1844, 1844, 356, 356, 1940, 1940, 540, 540, 756, 756, 284, 284, 1568, 1568, 932, 932, 1940, 1940, 1940, 1940, 1228, 1228, 1940, 1940, 692, 692, 648, 648, 564, 564, 440, 440, 1048, 1048, 520, 520, 1212, 1212, 660, 660, 512, 512, 648, 648, 588, 588, 820, 820, 924, 924, 956, 956, 1940, 1940, 716, 716, 460, 460, 872, 872, 852, 852, 520, 520, 604, 604, 856, 856, 1940, 1940, 340, 340, 1872, 1872, 848, 848, 1716, 1716, 428, 428, 1080, 1080, 1940, 1940, 976, 976, 1128, 1128, 716, 716, 616, 616, 220, 220, 1940, 1940, 1940, 1940, 956, 956, 364, 364, 720, 720, 468, 468, 920, 920, 1940, 1940, 664, 664, 740, 740, 1940, 1940, 1004, 1004, 684, 684, 736, 736, 1172, 1172, 1412, 1412, 552, 552, 1616, 1616, 752, 752, 520, 520, 696, 696, 1116, 1116, 1300, 1300, 1552, 1552, 584, 584, 1928, 1928, 784, 784, 1292, 1292, 452, 452, 252, 252, 1940, 1940, 1940, 1940, 1940, 1940, 864, 864, 588, 588, 892, 892, 928, 928, 628, 628, 548, 548, 1940, 1940, 1940, 1940, 584, 584, 1520, 1520, 1940, 1940, 1284, 1284, 868, 868, 608, 608, 332, 332, 1376, 1376, 1096, 1096, 396, 396, 1056, 1056, 768, 768, 1940, 1940, 860, 860, 376, 376, 428, 428, 980, 980, 1032, 1032, 564, 564, 1360, 1360, 1248, 1248, 1588, 1588, 1940, 1940, 988, 988, 660, 660, 1444, 1444, 1252, 1252, 1064, 1064, 1940, 1940, 636, 636, 792, 792, 1940, 1940, 468, 468, 816, 816, 784, 784, 1692, 1692, 756, 756, 896, 896, 336, 336, 1132, 1132, 1328, 1328, 796, 796, 1040, 1040, 536, 536, 1304, 1304, 1388, 1388, 1560, 1560, 544, 544, 1784, 1784, 1768, 1768, 1940, 1940, 536, 536, 604, 604, 1632, 1632, 1940, 1940, 1108, 1108, 468, 468, 1076, 1076, 1940, 1940, 812, 812, 1556, 1556, 696, 696, 544, 544, 1940, 1940, 1844, 1844, 1144, 1144, 772, 772, 520, 520, 1140, 1140, 1796, 1796, 1484, 1484, 804, 804]
    # selected_indices_68MHz = [0, 7, 8, 9, 11, 14, 18, 22, 24, 25, 26, 27, 28, 30, 31, 32, 33, 35, 38, 44, 45, 46, 47, 48, 49, 53, 55, 57, 58, 60, 62, 64, 66, 67, 68, 69, 70, 71, 72, 73]
    # selected_indices_185MHz  =[0, 1, 2, 3, 4, 5, 6, 10, 12, 13, 15, 16, 17, 19, 20, 21, 23, 29, 34, 36, 39, 40, 41, 42, 43, 50, 51, 52, 54, 56, 59, 61, 63, 65, 74]
    # readout_fidelity_list = [0.9477047684759228, 0.9019818104643178, 0.8869424289422583, 0.8381743391846024, 0.8576575496010796, 0.9789948892600422, 0.9638993329049552, 0.898366866628016, 0.8604145527053273, 0.8861698170034036, 0.9824776181718651, 0.8632153550685691, 0.827672837417338, 0.927171893427586, 0.8822325221734786, 0.9335430372381681, 0.9305713453369437, 0.8392023405939457, 0.9861011802108127, 0.8157486804611144, 0.7635968721186288, 0.8711321507405378, 0.8574018789954898, 0.9471240606747452, 0.8650241124111886, 0.7795173546830179, 0.8732039647833363, 0.9338104014779514, 0.9558981985343431, 0.9391611929957264, 0.9146476193680994, 0.8992855080604256, 0.9613121033462165, 0.9125277803864742, 0.9070326503772176, 0.7289693973579674, 0.9190545774848456, 0.9644449654863876, 0.8590194214802065, 0.9643977344841653, 0.8603012481973368, 0.8845957133999363, 0.9552186011814754, 0.8515459948543522, 0.8980333350254648, 0.9716402120536309, 0.8522768342108857, 0.75622300754898, 0.9012066681957438, 0.9078009184861564, 0.8813860966569098, 0.8906270590642871, 0.6954828186651594, 0.9023113184799078, 0.9416157243632285, 0.9178077991021585, 0.8818202711657068, 0.9771970009801894, 0.9349259629962237, 0.8692708549090551, 0.854909203398497, 0.9023536389202814, 0.8512346919968676, 0.9477524834507026, 0.8063005325042703, 0.8538797306542765, 0.9013512695010479, 0.7604219350887882, 0.8744548346014547, 0.8657098687476656, 0.8387730037442622, 0.8684496640789188, 0.9859277707961333, 0.8935054598943357, 0.937619675461284, 0.9684405921354535, 0.8999958079842622, 0.8769228046774404, 0.9259117545377555, 0.8785323119270279, 0.8151894722545696, 0.77971972500513, 0.8685481837641937, 0.9202166442782336, 0.8348105143985896, 0.8665580733373157, 0.8964005801357365, 0.7562539124805354, 0.8175266807405168, 0.9522214635766373, 0.818234794128154, 0.8931226388565615, 0.7541957525214444, 0.9250728459413826, 0.9001273915957506, 0.8718575938311778, 0.9332501628450971, 0.8441823712242635, 0.8586999734122533, 0.9255926356381402, 0.7609410590843866, 0.7760097193174632, 0.9207434709236447, 0.8745998904333208, 0.8339751355176769, 0.8516457240228907, 0.958969164565675, 0.9363830599017577, 0.8181843448249657, 0.8387597854986653, 0.8179687858039217, 0.7031746240540488, 0.7963382307094786, 0.9134333637733909, 0.9316656652625475, 0.8018907428540498, 0.9004409702526284, 0.8978715238068812, 0.8785740525205237, 0.8226698047862844, 0.799027545443247, 0.9239376094021214, 0.7754937730014869, 0.8003221282970276, 0.7795875836832522, 0.8122553700422762, 0.8583800093124666, 0.8279303898022159, 0.8304265331226003, 0.775813851482352, 0.7886620039060024]
    readout_fidelity_list = [0.7707640143529569, 0.8187825407623726, 0.9291563877385396, 0.831558382617186, 0.7964157730139787, 0.8014569700467378, 0.8100391607092303, 0.8099410802513997, 0.944137723765729, 0.7732966702400137, 0.7413162585419136, 0.7951424773054081, 0.8689692756548362, 0.7838962093666935, 0.7715620621870906, 0.7952833148476106, 0.8363330833718209, 0.7682407628898764, 0.7534232447149012, 0.850823269697472, 0.829739759243464, 0.8522220337287669, 0.8771770322176536, 0.7953311607065632, 0.7540983659321037, 0.8210727314936728, 0.7712595868060879, 0.7346669020749462, 0.8806687735306201, 0.8392860099359378, 0.7839855105576707, 0.808075812902818, 0.9165595614252147, 0.8625792029849961, 0.7426735680621788, 0.815316453662921, 0.7506462242985112, 0.7240872322925466, 0.7764313924565112, 0.7978845482370986, 0.7542497162644951, 0.8656075871572971, 0.8595931108088475, 0.8262459693558595, 0.8249160218106095, 0.7462622852750116, 0.7610925304417535, 0.7764088423941591, 0.7504355333437991, 0.9275077994478462, 0.7929916557295228, 0.7547930689723369, 0.7665043373332061, 0.7660132477540662, 0.8097029745243747, 0.8260964824062996, 0.7853276544970869, 0.9101731665019774, 0.7799129289728064, 0.8143521435057631, 0.8221085669494366, 0.8764664649193067, 0.890364006627292, 0.8539520330030854, 0.8614240892396079, 0.7480928667970475, 0.8869286000594659, 0.8223527318666253, 0.8176074831543801, 0.7731288144585051, 0.9002100990991809, 0.926576797980653, 0.8118121796855298, 0.8528723895129426, 0.8101972335168226, 0.7762946425957346, 0.774702160102601, 0.7476534527146064, 0.8090277328827281, 0.8155775921345542, 0.9377909945344158, 0.8386999286041779, 0.8106196812021897, 0.7878320509927532, 0.8610623713991016, 0.9239378992031602, 0.9215381157332896, 0.8192114329758001, 0.9032192483130232, 0.8245458927995685, 0.800445223991916, 0.9475447809289959, 0.8268342215875397, 0.7570420527059163, 0.8651781949871378, 0.8070744957478453, 0.7915446389587499, 0.8385963790380895, 0.8743513952256166, 0.8134284177357166, 0.7321387553403123, 0.7940289360201231, 0.8397601727007082, 0.7709527643502629, 0.8017299638082855, 0.7361816856745992, 0.7807789136895882, 0.783861252143558, 0.7912563462992536, 0.848394353704317, 0.9127550606203465, 0.7539517421046912, 0.8563985747364609, 0.7888980090864268, 0.8119045284121595, 0.7989893083412747, 0.7808760814186444, 0.7381192700100285, 0.8363040393191832, 0.8012629423372969, 0.822478473537767, 0.8709531017262133, 0.8423751131488755, 0.8212613722880432, 0.7272086184111645, 0.7705232700041271, 0.8155938621599292, 0.8492747442142985, 0.8253775237773885, 0.7908652703263672, 0.8871384142575114, 0.8594504374354088, 0.8071403688059418, 0.8660381061248669, 0.7576686761315743, 0.7293599136392217, 0.9200883313863942, 0.7797327472513402, 0.7950628478599738, 0.8272481829260494, 0.9087355860187505, 0.8129724407374697, 0.8322762797171213, 0.769924393760961, 0.7677032267824699, 0.7673056148208757, 0.7608199498701176, 0.8422997316450676, 0.8040996069231989, 0.8199270350750352, 0.8052901757495605, 0.8662818857548014, 0.7230415264571641, 0.7987765140609367, 0.7994803505782537, 0.7928623161539777, 0.7826945593041015, 0.8025174501438157, 0.7393078598253037, 0.9854402227542208, 0.7932304616261667, 0.7793494003474508, 0.8020498612883433, 0.8513761228019587, 0.7630192805507505, 0.8901378097966793, 0.7856135626371386, 0.9007518750568062, 0.8827765974769384, 0.8073690589831284, 0.7746192145884152, 0.8515759056106094, 0.8718335574994479, 0.8433028848880294, 0.8321596084737782, 0.7733987809811442, 0.8328951868330805, 0.886984101499473, 0.7965224584175566, 0.8145523643646637, 0.8778110403738137, 0.8138072998471493, 0.8159410378274521, 0.9117523626667094, 0.7611090864324209, 0.8220616836058723, 0.7684644512741913, 0.874535055235764, 0.8181771010264091, 0.8795120031569609, 0.7860824175357319, 0.7218180933469968, 0.8254263789592726, 0.7569314961865614, 0.8371175337487236, 0.8040035296097534, 0.804296271280037, 0.8255872577795824, 0.8599167267093561, 0.8002499803164951, 0.7905410645574531, 0.9574880930081779, 0.8403958471059443, 0.7831038248955624, 0.7425537654186931, 0.7871511938854695, 0.873043955228155, 0.793758543856711, 0.8496873872995963, 0.8410699332613794, 0.7771684200371094, 0.7780334976753271, 0.8637080692983412, 0.8122455103246577, 0.9200763569128549, 0.8258525712108585, 0.7848365949884997, 0.9167428561713333, 0.7701926287537858, 0.766979106750249, 0.7445503027771013, 0.869281442487273, 0.8437364219545083, 0.9238721749711252, 0.7381393390185429, 0.768515652227702, 0.7954406117144857, 0.7988349851252952, 0.8076511831362183, 0.8846845572032838, 0.834545657547054, 0.8266612584590668, 0.9138046481751174, 0.8001929640543348, 0.7900513435435635, 0.8016297734788722, 0.8116314850323016, 0.907848008418968, 0.7658744649045444, 0.7937459748611545, 0.811270068283891, 0.801899788050336, 0.7888929954974657, 0.8659550137332064, 0.8337902440269876, 0.7970002863225636, 0.8271790313637148, 0.9162234850006813, 0.7661602232677476, 0.7934668780209151, 0.7538138414577628, 0.861613003149399, 0.8332034498913304, 0.7513467970540266, 0.776966475285011, 0.7645469236557538, 0.8305517028448284, 0.7701604480230306, 0.8414113673330256, 0.7926926186989143, 0.8081383840605791, 0.8711712688423416, 0.8467337599759523, 0.7492359863961859, 0.8141528729194278, 0.7918785648170217, 0.818308282797862, 0.8871924474244639, 0.860843593364212, 0.8468518506369526, 0.7823804716730397, 0.785552919548651, 0.8941431722903148, 0.7449114741033079, 0.7982296035558831, 0.9385578627275895, 0.7776083985151012, 0.778449430598233, 0.7331994686240375, 0.8295994657044901, 0.8288702806818194, 0.8654448597246551, 0.8074826273486593, 0.8412287823773206, 0.9002849774141004, 0.7465599398382712, 0.7985530495379827, 0.8471605431505395, 0.8068723224166963, 0.8325861268332306, 0.8280887912274901, 0.8680649918188366, 0.78035474045142, 0.7656886861406248, 0.7989421828672066, 0.8126195048901039, 0.8612007537539373, 0.8638026502132478, 0.84309591695598, 0.7983365791037094, 0.8958476941244128, 0.8119979578069811, 0.7915587264399773, 0.7820182300594205, 0.8584408212717076, 0.8565313332490987, 0.8571154370237233, 0.8369941123495102, 0.7930414073519372, 0.8341744485392583, 0.923863832264791, 0.7922051250854037, 0.8291748353646599, 0.8244179734118984, 0.7846580278367659, 0.8602533871233387, 0.8595763182092628, 0.9091123177479231, 0.7959745131551256, 0.7438984189532678, 0.8089359717350505, 0.8720664334092981, 0.7954398076029697, 0.839736946195812, 0.9255818519093313, 0.8019511586040545, 0.8251695713217725, 0.7679852689461081, 0.8143756886382385, 0.7192484957077048, 0.8817640760375194, 0.7982858902731494, 0.8243948149328247, 0.7997833280656139, 0.8807118170015609, 0.8406318307234816, 0.7861666175972581, 0.8306360889627628, 0.7133863798234052, 0.8949086538031191, 0.7862062433022752, 0.8572204590704597, 0.8014927338417968, 0.779607355415124, 0.7444501944704796, 0.8437837738170095, 0.7844790425496802, 0.7899619633383257, 0.8580173566740295, 0.7857605657849961, 0.7562125208482238, 0.8116483053474584, 0.7984310472562197, 0.8256869447146513, 0.8120686102659527, 0.8590867287131002, 0.8118833753678038, 0.7285527715202487, 0.7674108674365163, 0.8305956042324185, 0.8938979393047937, 0.8008485681622172, 0.8571861242556829, 0.80616985283872, 0.8270119367944355, 0.8168303519824296, 0.7734159018843921, 0.7166233300746168, 0.9326749859101906, 0.8618155912378631, 0.8495690857528199, 0.8923826567884068, 0.8915936782073386, 0.9071474079687692, 0.7813699592097083, 0.85724223322733]
    prep_fidelity_list = [0.6045353512277631, 0.35207659381291145, 0.5075138406900664, 0.5488991391978821, 0.6369397344159315, 0.599570257865054, 0.7434788925933327, 0.7584887460724508, 0.2530869674370301, 0.7617888358926608, 0.725133284960778, 0.7538642871115753, 0.45921953418188455, 0.4618512412877197, 0.8046148339251016, 0.7151485189896583, 0.5542044197298392, 0.5377797722902078, 0.559968448307332, 0.573887717376536, 0.3914447144426123, 0.5009696081753066, 0.5403443524456044, 0.7074998207737608, 0.5923334616531819, 0.5274507823823043, 0.8359224821254005, 0.48207850117094486, 0.5261033400558406, 0.5814553594011276, 0.6983369216542122, 0.3028252064076622, 0.32334900063366856, 0.5180211727863103, 0.5451761984863309, 0.5262235819505822, 0.5636395759800961, 0.8218556673074859, 0.6072671728777808, 0.669800200548511, 0.5343731655648661, 0.5865177369275043, 0.5421518442137798, 0.5982015267347194, 0.5611670737846379, 0.6904921580666841, 0.5610713831530326, 0.6438801485955216, 0.7635057519051609, 0.34222736694389255, 0.5254447890260718, 0.44048923359896863, 0.6230055870341966, 0.5783217658021437, 0.6844344389737925, 0.5748611178942, 0.6016241814975691, 0.48706096949373734, 0.7941337405957295, 0.5312643907933172, 0.4674637158028355, 0.4618857994429396, 0.2693342370995434, 0.5435612744636682, 0.3466467831802629, 0.5278657288935069, 0.6408579412743698, 0.6380989966548318, 0.29691098717679376, 0.591856543823229, 0.33630438364554094, 0.4611695130492399, 0.714098006354233, 0.4977875764616072, 0.5675481123890692, 0.7566965456516014, 0.7481342062085834, 0.6262011109554777, 0.8860775686493617, 0.6693457908651466, 0.42894254052555203, 0.42853651219027766, 0.3992159861027691, 0.6463960315812699, 0.2735585837256653, 0.42871319875764624, 0.48523714304440624, 0.6697052582272826, 0.4015669133922686, 0.5632435067903038, 0.5860512973840029, 0.4894697576686303, 0.479534815405393, 0.6926990065544112, 0.5576737453423155, 0.4466007875873297, 0.8131313094590334, 0.5777199257404173, 0.24545102561383325, 0.5704573747377122, 0.7486350999941549, 0.7627465088993103, 0.4425338826737294, 0.7480752377000947, 0.5806707600963232, 0.7431127845738572, 0.6357744789212164, 0.4961994040725285, 0.6660705557733975, 0.4904661993730628, 0.5984686780818531, 0.7089769580129185, 0.6091661239742951, 0.7726853116860487, 0.5599817736456154, 0.5946475204381204, 0.5482135709780858, 0.6095512315574252, 0.5634138104911236, 0.7325444263092326, 0.6661685869850129, 0.5355247445845372, 0.5693290900603811, 0.6128324735708803, 0.641567305411499, 0.7155219590985606, 0.7364201292903686, 0.513329489736057, 0.5681074804632709, 0.6970280664398545, 0.3238979690682282, 0.521782493703642, 0.599083281085399, 0.5252140261590973, 0.5407531589575094, 0.694301606055094, 0.36714562688324826, 0.7041783398441325, 0.5756275426840226, 0.4530480085439611, 0.3630711843823524, 0.5384993400147452, 0.32781390720131565, 0.7253352189434042, 0.6093380922098319, 0.6327267573651836, 0.7164434787477877, 0.3954405721365519, 0.7731594355061864, 0.39089528357688375, 0.5916838155110291, 0.5629012043642894, 0.6779410003800759, 0.5082670723883751, 0.8077378985124419, 0.607456965614503, 0.5593781225277767, 0.568293753356308, 0.6695461002405247, 0.25112820395256874, 0.6805753039377122, 0.8110866938068828, 0.5925105674867951, 0.6137166582580382, 0.5816841317657114, 0.6119538709706893, 0.7499346985659552, 0.55036227178674, 0.5792832405774361, 0.8466191016706054, 0.8326528025447781, 0.3311903457818056, 0.5854072784075561, 0.6232893783374398, 0.4551412556144617, 0.6330447878076736, 0.5292173652260179, 0.5925062411694583, 0.5999414315938769, 0.7944184254980683, 0.4219983308763534, 0.5150522910091716, 0.6333933698771446, 0.4448921387980208, 0.7664489491411003, 0.7530039547159897, 0.7341268141992824, 0.4747632714786706, 0.585609381864137, 0.40997893537786756, 0.6046032717302587, 0.6155031333152171, 0.6518336009772447, 0.722846153772468, 0.6646500854789561, 0.46376520713223124, 0.6827979965878003, 0.5696957978464214, 0.6398193935170065, 0.5691610910664537, 0.663557281268185, 0.3363433381727018, 0.6174087484373119, 0.6721668164826555, 0.6409234520863356, 0.6199303480193619, 0.4115407898084956, 0.6434364052928385, 0.6365007211578232, 0.46515496783928745, 0.6375315196405458, 0.564882387273574, 0.49536496925940476, 0.518885112293426, 0.47135188298578434, 0.7050089228408454, 0.7825221261835477, 0.28724143182231676, 0.7971710512400204, 0.6568024923056595, 0.6320921153036272, 0.4919665797731594, 0.6896162136208277, 0.49817563482494276, 0.6718961961727933, 0.653986854258412, 0.5920855749745116, 0.5327100940673115, 0.5153020602579381, 0.41899215743655827, 0.637537626483339, 0.33797668872999975, 0.593032764446373, 0.6355971713785428, 0.6355556896486362, 0.6606976856193241, 0.6431115659098885, 0.6042974176338941, 0.6580065093603765, 0.6180363241658997, 0.6577314478979713, 0.6581454119474905, 0.6146100758548567, 0.6773731010664408, 0.45678777558464434, 0.6052364818647568, 0.6155875720356594, 0.5125323758534435, 0.731626501516097, 0.5544299125598967, 0.49280749578158345, 0.4947379731492708, 0.4176468967427809, 0.6343452138401517, 0.628784064630987, 0.6247567937232109, 0.6509075484676481, 0.7248154406527114, 0.5524840825806967, 0.682153472207319, 0.6642902195821951, 0.5389264487555983, 0.4866961522245635, 0.7274136257411348, 0.6510196226427425, 0.581939542373298, 0.4767581486647876, 0.5858721523800967, 0.46674089139086494, 0.4961271875785507, 0.564947434977321, 0.6884844684001382, 0.6292361262421198, 0.5494969969963042, 0.750584633981976, 0.3631275810430067, 0.6652539271313006, 0.5908761869342686, 0.4856346423991382, 0.5593475470053562, 0.6831071745742864, 0.27392552841620355, 0.590515111815684, 0.6041898709726761, 0.5726557670821952, 0.7277513494263039, 0.7419508206598449, 0.6020244711381135, 0.48755530540032144, 0.5690012850790555, 0.4180451817953802, 0.6015615005087991, 0.6958190436054895, 0.7090343149433379, 0.7834121941110443, 0.612904407629782, 0.5668307591489533, 0.5198464748489614, 0.6181299099830111, 0.6262810080440371, 0.4902321011084487, 0.6070923391099476, 0.4601160315267644, 0.6422493919020531, 0.33066150059126764, 0.6689893362506649, 0.40697624116066256, 0.5686667581219613, 0.523525066374521, 0.6086855184691176, 0.5705512749829108, 0.34799142849818376, 0.6284359235606476, 0.5438873105197068, 0.6162764006383028, 0.6310492152091571, 0.5768780971562377, 0.5435806976292537, 0.562931628617186, 0.4286330479103114, 0.640915176691209, 0.5236140544118849, 0.5769994771790187, 0.5958097146140842, 0.5486668351047639, 0.5497394176774946, 0.6795518771059865, 0.5940338654227666, 0.500893811732295, 0.6609463028341347, 0.4675719720547574, 0.5764720026210982, 0.5882158078737277, 0.6344598487493385, 0.3665677283257741, 0.521599143925064, 0.7375454987217762, 0.5501664452254655, 0.592629880568357, 0.5947695837197577, 0.7142048730699015, 0.6092612073844978, 0.6579524916612415, 0.5346192219667154, 0.6487235911201821, 0.6011043339028579, 0.7156454459837576, 0.5246201803974868, 0.7060333640565049, 0.7663337765276743, 0.6413278808944682, 0.5445348681968591, 0.4316296541175466, 0.4653363387020527, 0.40932964668653693, 0.6029711607854955, 0.6618266670765036, 0.4698044351888131, 0.5952210775283981, 0.69177526338198, 0.46006543595293536, 0.774570478973976, 0.41617585758511233, 0.7055026693772892, 0.6226878440888415, 0.5977658629204197, 0.5509884699790675, 0.4897665430235515, 0.5240675693844725, 0.5819865182528219, 0.5291688129965573, 0.4576009330534999, 0.4903624908514199, 0.43408197240919855, 0.6779508653646076, 0.584197146451918]
    include_indices = [i for i, (val1, val2) in enumerate(zip(readout_fidelity_list, prep_fidelity_list))
                       if val1 >= 0.70 and val2 >= 0.40]
    # include_indices = [i for i, val in enumerate(prep_fidelity_list) if val >= 0.4 or val is None]
    # import math
    # include_indices = [
    #     i for i, val in enumerate(prep_fidelity_list)
    #     if (val is None) or (isinstance(val, (int, float)) and not math.isnan(val) and val >= 0.5)
    # ]

    # print(np.sort(list(include_indices)))
    # print("[" + ", ".join(map(str, np.sort(list(include_indices)))) + "]")

    #rubin
    # include_indices = [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 21, 22, 23, 24, 26, 27, 28, 30, 31, 32, 33, 34, 36, 37, 38, 40, 41, 43, 46, 48, 49, 50, 51, 53, 55, 58, 60, 61, 62, 63, 64, 65, 68, 69, 70, 71, 73, 76, 77, 78, 79, 80, 82, 83, 88, 90, 91, 93, 94, 96, 98, 99, 102, 103, 104, 105, 107, 108, 109, 110, 113, 114, 115, 116, 117, 118, 121, 123, 125, 126, 127, 128]
    # nv_powers = [val for ind, val in enumerate(nv_powers) if ind not in drop_indices]
    # print(np.sum(nv_powers))
    # 117 NVs
    # include_indices =[0, 1, 2, 3, 5, 6, 7, 8, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 33, 34, 36, 37, 39, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 55, 56, 57, 58, 60, 61, 62, 64, 65, 66, 68, 69, 70, 71, 72, 73, 74, 75, 77, 79, 83, 84, 85, 88, 89, 90, 91, 92, 94, 95, 96, 97, 99, 100, 101, 102, 103, 105, 106, 107, 108, 109, 110, 111, 113, 114, 116, 117, 118, 120, 122, 123, 124, 125, 128, 131, 132, 134, 136, 137, 138, 140, 141, 142, 145, 146, 147, 148, 149, 152, 153, 154, 155, 156, 157, 158, 159]
    # SHALLOW nvS
    # include_indices = [0, 1, 5, 6, 10, 17, 19, 20, 24, 26, 29, 35, 36, 43, 44, 46, 48, 49, 52, 53, 55, 57, 58, 62, 64, 65, 66, 68, 70, 72, 73, 74, 75, 78, 80, 82, 83, 90, 91, 93, 94, 95, 98, 99, 102, 103, 110, 111, 112, 113, 116, 122, 124, 126, 129, 130, 131, 136, 138, 142, 146]
    # include_indices = list(range(160))
    # include_indices = [0, 3, 4, 6, 7, 8, 13, 14, 19, 20, 22, 25, 26, 30, 31, 33, 36, 38, 39, 42, 43, 50, 51, 52, 58, 59, 61, 62, 63, 64, 65, 74, 75, 76, 77, 78, 79, 83, 84, 86, 88, 90, 91, 92, 95, 96, 99, 101, 105, 107, 109, 110, 112, 113, 119, 121, 126, 127, 128, 132, 133, 134, 136, 139, 140, 141, 143, 145, 146]
    # include_indices = [ind for ind in include_indices if ind not in final_drop_inds]
    # include_indices = [0, 1, 3, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 21, 23, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 43, 44, 46, 48, 51, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 64, 65, 66, 67, 68, 69, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 82, 87, 89, 90, 92, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 108, 109, 111, 112, 113, 114, 117, 118, 119, 121, 122, 124, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 139]
    # include_indices_1 = [0, 3, 6, 8, 9, 10, 11, 18, 20, 21, 23, 24, 29, 34, 36, 39, 41, 42, 52, 63, 64, 69, 79, 82, 84, 85, 86, 98, 99, 101, 102, 105, 106, 115, 116, 120, 123, 129, 150, 152]
    # include_indices_2 =  [12, 13, 16, 19, 22, 35, 40, 43, 45, 49, 50, 51, 54, 56, 57, 59, 72, 75, 89, 91, 92, 93, 94, 95, 96, 103, 107, 108, 113, 117, 122, 124, 128, 131, 132, 133, 135, 136, 137, 139, 142, 146]
    # include_indices= sorted(set(include_indices_1 + include_indices_2))
    # print(include_indices)
    # print(len(include_indices))
    # fmt: on
    # filtered_reordered_coords = [filtered_reordered_coords[i] for i in include_indices]
    # print(f"len filtered_reordered_coords: {len(filtered_reordered_coords)}")
    # # # select_half_left_side_nvs_and_plot(nv_coordinates_filtered)
    # spot_weights_filtered = np.array(
    #     [weight for i, weight in enumerate(spot_weights) if i in include_indices]
    # )
    # filtered_pol_durs = np.array(
    #     [weight for i, weight in enumerate(pol_durs) if i in include_indices]
    # )
    # print(filtered_pol_durs.tolist())
    # print(len(spot_weights_filtered))

    aom_voltage = 0.207479
    # a, b, c = [3.7e5, 6.97, 8e-14]
    # a, b, c = 161266.751, 6.617, -19.492
    a, b, c = 1.5133e04, 2.6976, -38.63  # UPDATED 2025-09-17

    total_power = a * (aom_voltage) ** b + c
    # print(total_power)
    normalized_spot_weigths = spot_weights / np.sum(spot_weights)
    nv_powers = total_power * normalized_spot_weigths
    # print(nv_powers)
    # print(nv_powers)
    # calcualted_spot_weights = linear_weights(filtered_reordered_counts, alpha=0.3)
    # updated_spot_weights = linear_weights(filtered_reordered_counts, alpha=0.6)
    nv_powers_filtered = np.array(
        [power for i, power in enumerate(nv_powers) if i in include_indices]
    )
    print(nv_powers_filtered)
    # Create a copy or initialize spot weights for modification
    # updated_spot_weights = curve_extreme_weights_simple(
    #     spot_weights, scaling_factor=1.0
    # )
    # filtered_reordered_spot_weights = np.array(
    #     [
    #         weight
    #         for i, weight in enumerate(updated_spot_weights)
    #         if i in include_indices
    #     ]
    # )
    # updated_spot_weights = spot_weights
    # print(filter_and_reorder_nv_coords)
    # updated_spot_weights = np.array(
    #     [w for i, w in enumerate(updated_spot_weights_0) if i in include_indices]
    # )
    # updated_spot_weights = spot_weights
    # updated_spot_weights = curve_extreme_weights_simple(nv_powers)
    # updated_spot_weights = curve_inverse_counts(filtered_reordered_spot_weights)
    # drop_indices = [42, 49, 53, 62, 75, 79]
    # updated_spot_weights = [
    #     val for ind, val in enumerate(updated_spot_weights) if ind not in drop_indices
    # ]
    # filtered_reordered_coords = [
    #     filtered_reordered_coords[ind]
    #     for ind in range(len(filtered_reordered_coords))
    #     if ind not in drop_indices
    # ]
    # nv_powers = [val for ind, val in enumerate(nv_powers) if ind not in drop_indices]

    ### new weithgs for 75 NVs
    # fmt: off
    # spot_weights = [1.5095766644650288, 0.9618852387815993, 1.0430775922714643, 0.4436039796130322, 1.0430775922714643, 1.5095766644650288, 0.30376599435099677, 1.310540492774533, 1.4079312952605532, 0.6747045661156417, 0.4964211566919598, 0.7410295032188732, 1.0430775922714643, 1.0430775922714643, 0.6118852419676627, 0.552486087697023, 0.552486087697023, 0.3939475438077535, 0.7410295032188732, 0.9618852387815993, 0.8845355774031071, 0.3939475438077535, 0.8109450107566616, 1.1281958109476427, 1.5095766644650288, 1.4079312952605532, 1.4079312952605532, 0.552486087697023, 0.4436039796130322, 0.3939475438077535, 1.2173226567254087, 0.7410295032188732, 0.8845355774031071, 0.552486087697023, 1.0430775922714643, 0.4964211566919598, 1.5095766644650288, 1.4079312952605532, 0.6747045661156417, 0.6118852419676627, 1.5095766644650288, 0.6118852419676627, 0.3939475438077535, 1.1281958109476427, 0.8845355774031071, 1.2173226567254087, 1.4079312952605532, 0.6118852419676627, 1.310540492774533, 1.5095766644650288, 1.1281958109476427, 1.310540492774533, 0.7410295032188732, 1.310540492774533, 1.5095766644650288, 0.8845355774031071, 1.5095766644650288, 0.7410295032188732, 0.9618852387815993, 0.3473642711816343, 0.6747045661156417, 0.6747045661156417, 1.310540492774533, 0.6118852419676627, 0.6118852419676627, 1.4079312952605532, 0.3939475438077535, 0.6118852419676627, 1.2173226567254087, 1.4079312952605532, 1.4079312952605532, 0.6747045661156417, 1.310540492774533, 1.0430775922714643, 1.0430775922714643, 1.0430775922714643, 1.4079312952605532, 1.2173226567254087, 1.4079312952605532, 0.3473642711816343, 1.2173226567254087, 0.8109450107566616, 0.9618852387815993, 1.5095766644650288, 1.4079312952605532, 1.2173226567254087, 0.8109450107566616, 1.310540492774533, 0.552486087697023, 1.4079312952605532, 1.0430775922714643, 0.7410295032188732, 0.4964211566919598, 0.7410295032188732, 0.6747045661156417, 1.310540492774533, 0.9618852387815993, 1.5095766644650288, 0.8845355774031071, 0.8109450107566616, 1.310540492774533, 1.4079312952605532, 0.8109450107566616, 1.310540492774533, 1.1281958109476427, 1.4079312952605532, 1.2173226567254087, 0.8845355774031071, 0.7410295032188732, 0.6118852419676627, 1.1281958109476427, 0.8109450107566616, 1.1281958109476427, 0.7410295032188732, 1.1281958109476427, 1.5095766644650288, 0.6118852419676627, 1.5095766644650288, 1.2173226567254087, 0.7410295032188732, 0.6118852419676627, 0.7410295032188732, 1.310540492774533, 1.0430775922714643, 1.4079312952605532, 0.7410295032188732, 1.2173226567254087, 1.5095766644650288, 1.310540492774533, 0.9618852387815993, 1.310540492774533, 0.6747045661156417, 0.7410295032188732, 1.0430775922714643, 1.4079312952605532, 0.6747045661156417, 0.3939475438077535, 0.6118852419676627, 0.7410295032188732, 1.310540492774533, 1.5095766644650288, 1.2173226567254087, 1.2173226567254087, 0.9618852387815993, 0.6747045661156417, 1.2173226567254087, 1.2173226567254087, 0.4964211566919598, 1.2173226567254087, 0.6118852419676627, 0.8109450107566616, 1.0430775922714643, 1.4079312952605532, 0.3939475438077535, 0.7410295032188732, 1.4079312952605532, 0.9618852387815993, 1.310540492774533, 1.1281958109476427, 1.4079312952605532, 1.5095766644650288, 1.0430775922714643, 0.7410295032188732, 1.4079312952605532, 1.5095766644650288, 1.4079312952605532, 1.4079312952605532, 0.552486087697023, 0.3939475438077535, 0.8845355774031071, 0.552486087697023, 0.6118852419676627, 0.6747045661156417, 0.6747045661156417, 0.552486087697023, 1.4079312952605532, 1.5095766644650288, 1.4079312952605532, 1.1281958109476427, 0.8109450107566616, 0.8845355774031071, 1.1281958109476427, 0.9618852387815993, 1.1281958109476427, 1.0430775922714643, 1.310540492774533, 0.6747045661156417, 1.0430775922714643, 1.5095766644650288, 1.2173226567254087, 1.4079312952605532, 1.1281958109476427, 1.0430775922714643, 0.9618852387815993, 0.8109450107566616, 0.552486087697023, 0.30376599435099677, 1.310540492774533, 0.4964211566919598, 0.6118852419676627, 0.7410295032188732, 0.7410295032188732, 1.2173226567254087, 0.8845355774031071, 0.8109450107566616, 1.5095766644650288, 0.8845355774031071, 0.9618852387815993, 1.2173226567254087, 1.2173226567254087, 1.1281958109476427, 0.8109450107566616, 0.552486087697023, 1.2173226567254087, 1.2173226567254087, 0.9618852387815993, 0.6118852419676627, 1.310540492774533, 0.9618852387815993, 1.4079312952605532, 0.8109450107566616, 0.6118852419676627, 0.8109450107566616, 1.4079312952605532, 0.7410295032188732, 1.2173226567254087, 1.310540492774533, 0.7410295032188732, 0.4436039796130322, 1.0430775922714643, 1.5095766644650288, 1.1281958109476427, 0.8109450107566616, 0.8109450107566616, 0.7410295032188732, 1.0430775922714643, 1.310540492774533, 1.2173226567254087, 0.8109450107566616, 0.7410295032188732, 1.4079312952605532, 1.4079312952605532, 1.2173226567254087, 0.4964211566919598, 1.4079312952605532, 0.9618852387815993, 1.5095766644650288, 1.2173226567254087, 0.6118852419676627, 1.0430775922714643, 0.7410295032188732, 0.9618852387815993, 0.6118852419676627, 0.4964211566919598, 1.5095766644650288, 0.8845355774031071, 1.1281958109476427, 1.4079312952605532, 0.9618852387815993, 0.6747045661156417, 1.310540492774533, 0.8845355774031071, 0.4436039796130322, 1.2173226567254087, 0.6747045661156417, 0.3939475438077535, 0.6118852419676627, 0.9618852387815993, 0.6747045661156417, 0.7410295032188732, 1.4079312952605532, 0.8845355774031071, 0.7410295032188732, 0.9618852387815993, 1.1281958109476427, 1.2173226567254087, 0.8845355774031071, 0.7410295032188732, 0.552486087697023, 1.1281958109476427, 1.1281958109476427, 1.4079312952605532, 1.0430775922714643, 0.8845355774031071, 0.552486087697023, 0.8109450107566616, 0.6747045661156417, 1.5095766644650288, 1.310540492774533, 1.1281958109476427, 0.8109450107566616, 1.2173226567254087, 1.0430775922714643, 1.2173226567254087, 0.7410295032188732, 1.4079312952605532, 1.5095766644650288, 1.0430775922714643, 1.1281958109476427, 1.4079312952605532, 1.310540492774533, 0.9618852387815993, 1.4079312952605532, 1.5095766644650288, 0.6118852419676627, 0.8109450107566616, 1.5095766644650288, 1.310540492774533, 0.6747045661156417, 1.310540492774533, 0.552486087697023, 1.1281958109476427, 1.5095766644650288, 0.6747045661156417, 0.9618852387815993, 0.6747045661156417, 1.310540492774533, 0.8845355774031071, 1.4079312952605532, 0.6118852419676627, 1.2173226567254087, 0.8109450107566616, 0.552486087697023, 1.5095766644650288, 0.6747045661156417, 0.7410295032188732, 1.310540492774533, 0.6118852419676627, 0.4436039796130322, 1.310540492774533, 0.9618852387815993, 1.2173226567254087, 1.310540492774533, 1.310540492774533, 1.310540492774533, 1.310540492774533, 1.310540492774533, 0.7410295032188732, 0.9618852387815993, 1.4079312952605532, 1.310540492774533, 0.8845355774031071, 0.9618852387815993, 0.8845355774031071, 1.4079312952605532, 0.4964211566919598, 1.0430775922714643, 1.4079312952605532, 0.6747045661156417, 0.7410295032188732, 0.7410295032188732, 1.2173226567254087, 1.2173226567254087, 0.552486087697023, 1.310540492774533, 0.7410295032188732, 1.4079312952605532, 1.0430775922714643, 0.6118852419676627, 1.310540492774533, 0.8109450107566616, 1.5095766644650288, 0.3939475438077535, 0.8845355774031071, 0.9618852387815993, 0.8109450107566616, 0.8845355774031071, 1.1281958109476427, 1.4079312952605532, 0.8109450107566616] 
    #fmt: off
    # spot_weights_med = np.median(spot_weights)
    # spot_weights = [spot_weights_med if spot_weights[ind] > 3 else spot_weights[ind] for ind in range(len(spot_weights))]
    updated_spot_weights = curve_extreme_weights_simple(
        spot_weights, scaling_factor=1.0
    )
    # Update weights for the specified indices using the calculated weights
    # fmt: off
    # selected_indices_68MHz = [0, 7, 8, 9, 11, 14, 18, 22, 24, 25, 26, 27, 28, 30, 31, 32, 33, 35, 38, 44, 45, 46, 47, 48, 49, 53, 55, 57, 58, 60, 62, 64, 66, 67, 68, 69, 70, 71, 72, 73]
    # selected_indices_185MHz  =[0, 1, 2, 3, 4, 5, 6, 10, 12, 13, 15, 16, 17, 19, 20, 21, 23, 29, 34, 36, 39, 40, 41, 42, 43, 50, 51, 52, 54, 56, 59, 61, 63, 65, 74]
    # selected_indices = selected_indices_185MHz
    # fmt: on
    # updated_spot_weights = [
    #     val for ind, val in enumerate(updated_spot_weights) if ind in selected_indices
    # ]
    # filtered_reordered_coords = [
    #     filtered_reordered_coords[ind]
    #     for ind in range(len(filtered_reordered_coords))
    #     if ind in selected_indices
    # ]
    # nv_powers = [val for ind, val in enumerate(nv_powers) if ind in selected_indices]

    ####
    filtered_total_power = np.sum(nv_powers_filtered)
    print(total_power)
    adjusted_aom_voltage = ((filtered_total_power - c) / a) ** (1 / b)
    print("Adjusted Voltages (V):", adjusted_aom_voltage)
    # sys.exit()
    # updated_spot_weights = [
    #     np.median(updated_spot_weights) + 0.1 if ind == 42 else val
    #     for ind, val in enumerate(updated_spot_weights)
    # ]

    filtered_reordered_spot_weights = updated_spot_weights

    # filtered_reordered_coords, filtered_reordered_spot_weights, include_indices = (
    #     filter_and_reorder_nv_coords(
    #         filtered_reordered_coords,
    #         filtered_reordered_spot_weights,
    #         reference_nv,
    #         min_distance=9,
    #     )
    # )
    print("filtered_reordered_spot_weights_len:", len(filtered_reordered_spot_weights))
    print("filtered_reordered_coords_len:", len(filtered_reordered_coords))
    print("filtered_nv_power_len:", len(nv_powers_filtered))
    print("NV Index | Coords    |   previous weights")
    print("-" * 60)
    for idx, (coords, weight) in enumerate(
        zip(filtered_reordered_coords, filtered_reordered_spot_weights)
    ):
        print(f"{idx + 1:<8} | {coords} | {weight:.3f}")

    print(adjusted_aom_voltage)

    # print(np.max(filtered_reordered_spot_weights))
    # print(np.median(filter_and_reorder_nv_coords))
    # sys.exit()
    # print(len(spot_weights))
    # updated_spot_weights = filtered_reordered_counts
    # spot_weights = updated_spot_weights
    # spot_weights = linear_weights(filtered_reordered_counts, alpha=0.9)
    # spot_weights = non_linear_weights_adjusted(
    #     filtered_intensities, alpha=0.9, beta=0.3, threshold=0.9
    # )
    # spot_weights = sigmoid_weights(filtered_intensities, threshold=0, beta=0.005)
    # Print some diagnostics
    # Update spot weights for NVs with low fidelity

    # Calculate the spot weights based on the integrated intensities
    # spot_weights = non_linear_weights(filtered_intensities, alpha=0.9)

    # Save the filtered results
    save_results(
        filtered_reordered_coords,
        filtered_reordered_spot_weights,
        filename="slmsuite/nv_blob_detection/nv_blob_337nvs_reordered.npz",
    )
    # save_results(
    #     nv_coordinates,
    #     filtered_reordered_counts,
    #     nv_weights,
    #     updated_spot_weights,
    #     filename="slmsuite/nv_blob_detection/nv_blob_filtered_160nvs_reordered_selected_117nvs_updated.npz",
    # filename="slmsuite/nv_blob_detection/nv_blob_filtered_160nvs_reordered.npz",
    # )

    # # Plot the original image with circles around each NV

    fig, ax = plt.subplots()
    title = "12ms, INTI_520_Combined_Image"
    kpl.imshow(ax, img_array, title=title, cbar_label="Photons")
    # Draw circles and index numbers
    for idx, coord in enumerate(filtered_reordered_coords):
        circ = plt.Circle(coord, sigma, color="lightblue", fill=False, linewidth=0.5)
        ax.add_patch(circ)
        # Place text just above the circle
        ax.text(
            coord[0],
            coord[1] - sigma - 1,
            str(idx),
            color="white",
            fontsize=8,
            ha="center",
        )

    # fig, ax = plt.subplots()
    # title = "50ms, Ref"
    # plt.imshow(img_array)
    # # Remove axis ticks
    # ax.set_xticks([])
    # ax.set_yticks([])
    # Save as SVG
    # plt.savefig("output.svg", format="svg", bbox_inches="tight")

    # Draw circles and index numbers
    # Plot histogram of the filtered integrated intensities using Seaborn
    # sns.set(style="whitegrid")

    # plt.figure(figsize=(6, 5))
    # sns.histplot(filtered_counts, bins=45, kde=False, color="blue")

    # plt.xlabel("Integrated Intensity")
    # plt.ylabel("Frequency")
    # plt.title("Histogram of Filtered Integrated Counts")
    plt.show(block=True)

    # # Re-import necessary libraries after execution state reset
    # import matplotlib.pyplot as plt
    # import numpy as np
    # from scipy.optimize import curve_fit

    # # Given data points
    # aom_voltages = np.array(
    #     [0.25, 0.27, 0.29, 0.31, 0.33, 0.35, 0.37, 0.39, 0.41, 0.43, 0.45]
    # )
    # yellow_power = np.array(
    #     [6, 13, 25, 45, 78, 129, 200, 297, 435, 595, 790]
    # )  # Updated power values

    # # Define the power law model
    # def power_law_model(x, a, b, c):
    #     return a * np.power(x, b) + c

    # # Fit the curve using non-linear least squares
    # params, covariance = curve_fit(
    #     power_law_model, aom_voltages, yellow_power, maxfev=5000
    # )

    # # Extract parameters
    # a, b, c = params

    # # Generate fitted data for plotting
    # voltage_fit = np.linspace(aom_voltages.min(), aom_voltages.max(), 500)
    # power_fit = power_law_model(voltage_fit, a, b, c)

    # # Plot the data and the fit
    # plt.figure(figsize=(8, 6))
    # plt.scatter(aom_voltages, yellow_power, color="blue", label="Data Points")
    # plt.plot(
    #     voltage_fit,
    #     power_fit,
    #     color="red",
    #     label=f"Fit: $y = {a:.2f} \\cdot x^{{{b:.2f}}} + {c:.2f}$",
    # )
    # plt.title("AOM Voltage vs Yellow Laser Power")
    # plt.xlabel("AOM Voltage (V)")
    # plt.ylabel("Yellow Laser Power (µW)")
    # plt.legend()
    # plt.grid(True)
    # plt.show()

    # # Print the fitted function
    # fitted_function = f"Fitted Function: y = {a:.3f} * x^{b:.3f} + {c:.3f}"
    # fitted_para = f"Fitted para: y = {a:.3f} * x^{b:.3f} + {c:.3f}"
    # print(fitted_function)
